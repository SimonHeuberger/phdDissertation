
R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> rm(list=ls())
> 
> library(blockTools)
> library(randomizr)
> library(plyr)
> library(ggplot2)
> 
> ## Save .csv files for blocked and randomized ##
> ## Sample is between 6 and 1000, with variations and sequences for different group sizes
> ## Following Ryan's suggestion, I set the seq() to bigger iterations, to keep the calulcation time, resulting file size and density down
> ## Repeats: 100
> ## Levels: 5
> ## Groups: 2
> 
> sampled_numbers <- seq(from = 6, to = 1000, by = 8)
> length(sampled_numbers)
[1] 125
> repeats <- 100
> lev <- 5
> groups <- as.factor(c("control", "treatment"))
> listoflists <- rep(list(list()), length(lev)) # lists with with length(lev) # of lists
> 
> df <- data.frame(matrix(NA, repeats, (length(groups)+2))) 
> # +2 to add variance and levels columns after the treatment group columns
> colnames(df) <- c(levels(groups), "variance", "levels")
> secondlistofdfs <- rep(list(df), length(sampled_numbers)) # list with length(sampled_numbers) # of df
> secondlistoflists <- rep(list(secondlistofdfs), length(lev)) # list with length(lev) # of secondlistofdfs
> thirdlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> fourthlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> 
> pb <- txtProgressBar(min = 1, max = length(sampled_numbers), style = 3)
> 
> for(q in 1:length(lev)){
+   for(x in 1:length(sampled_numbers)){
+     setTxtProgressBar(pb, x)
+     listoflists[[q]][[x]] <- data.frame(replicate(repeats, sample(lev[q], sampled_numbers[x], replace = TRUE))) 
+     # randomly sample numbers
+     listoflists[[q]][[x]]$levels <- rep(lev[q], sampled_numbers[x]) 
+     # add column of levels used
+     listoflists[[q]][[x]]$groups <- simple_ra(N = sampled_numbers[x], conditions=groups)  
+     # assign treatment for each amount of randomly sampled numbers and add as column
+     listoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], sampled_numbers[x]) 
+     # add column of amount of sampled numbers
+     listoflists[[q]][[x]]$repeats <- rep(repeats, sampled_numbers[x]) 
+     # add column of repeats made
+     listoflists[[q]][[x]]$id <- 1:sampled_numbers[x]
+     # add column of continuous id (for blocking)
+       for(i in 1:repeats){
+         thirdlistoflists[[x]][[i]] <- assignment(block(listoflists[[q]][[x]], id.vars = "id", block.vars = names(listoflists[[q]][[x]])[i], n.tr = length(groups)))
+         # block and assign samples to treatment groups
+         fourthlistoflists[[x]][[i]] <- list(cbind(rep(sampled_numbers[x], sampled_numbers[x]/length(groups)), thirdlistoflists[[x]][[i]]$assg[[1]]$Distance))
+         # bind levels of sampled_numbers with equivalent group diffs
+         for(z in 1:length(groups)){
+           secondlistoflists[[q]][[x]][i,z] <- mean(listoflists[[q]][[x]][,i][listoflists[[q]][[x]]$groups == levels(groups)[z]]) 
+           # take means of each treatment group and add to dataframe
+         }
+         secondlistoflists[[q]][[x]][i,(length(groups)+1)] <- var(listoflists[[q]][[x]][,i]) 
+         # take variance of each repeat and add to dataframe
+         secondlistoflists[[q]][[x]][i,(length(groups)+2)] <- lev[q] 
+         # add levels used to dataframe
+       }  
+     secondlistoflists[[q]][[x]]$groups <- rep(length(groups), repeats) 
+     secondlistoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], repeats)
+     secondlistoflists[[q]][[x]]$repeats <- rep(repeats, repeats)
+     }
+ }
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%> 
> list_all_samples <- unlist(listoflists, recursive=FALSE) 
> # turn listoflists (which is a list of lists of dataframes) into a list of dataframes
> list_all_means_variances <- unlist(secondlistoflists, recursive = FALSE) 
> # same for secondlistoflists
> all_samples <- ldply(list_all_samples, data.frame) 
> # turn the list of dataframes of all samples into one giant dataframe of all samples
> all_means_variances <- ldply(list_all_means_variances, data.frame) 
> # same for list of dataframes of all means and variances
> all_means_variances$diff <- apply(all_means_variances[,1:length(groups)], 1, function(x) diff(range(x)))
> # calculate the maximum diff between treatment groups
> all_means_variances$label <- c(rep("rand", nrow(all_means_variances)))
> # add the label "rand" to all rows (for plotting)
> list_all_blocked <- unlist(fourthlistoflists, recursive = FALSE) 
> # turn fourthlistoflists (which is a list of lists of dataframes) into a list of dataframes
> all_blocked <- ldply(list_all_blocked, data.frame)
> # turn the list of dataframes with all blocked diffs into one giant dataframe of all diffs
> colnames(all_blocked) <- c("sampled_numbers", "diff")
> # add column names
> all_blocked$label <- c(rep("blocked", nrow(all_blocked)))
> # add the label "blocked" to all rows (for plotting)
> 
> write.csv(all_samples, file = "all_samples_2.csv")
> write.csv(all_means_variances, file = "all_means_variances_2.csv")
> write.csv(all_blocked, file = "all_blocked_2.csv")
> 
> rm(list=ls())
> 
> 
> 
> 
> ## Save .csv files for blocked and randomized ##
> ## Same as above, just for 3 groups ##
> 
> sampled_numbers <- seq(from = 9, to = 1002, by = 9)
> length(sampled_numbers)
[1] 111
> repeats <- 100
> lev <- 5
> groups <- as.factor(c("control", "treatment1", "treatment2"))
> listoflists <- rep(list(list()), length(lev)) # lists with with length(lev) # of lists
> 
> df <- data.frame(matrix(NA, repeats, (length(groups)+2))) 
> # +2 to add variance and levels columns after the treatment group columns
> colnames(df) <- c(levels(groups), "variance", "levels")
> secondlistofdfs <- rep(list(df), length(sampled_numbers)) # list with length(sampled_numbers) # of df
> secondlistoflists <- rep(list(secondlistofdfs), length(lev)) # list with length(lev) # of secondlistofdfs
> thirdlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> fourthlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> 
> pb <- txtProgressBar(min = 1, max = length(sampled_numbers), style = 3)
> 
> for(q in 1:length(lev)){
+   for(x in 1:length(sampled_numbers)){
+     setTxtProgressBar(pb, x)
+     listoflists[[q]][[x]] <- data.frame(replicate(repeats, sample(lev[q], sampled_numbers[x], replace = TRUE))) 
+     # randomly sample numbers
+     listoflists[[q]][[x]]$levels <- rep(lev[q], sampled_numbers[x]) 
+     # add column of levels used
+     listoflists[[q]][[x]]$groups <- simple_ra(N = sampled_numbers[x], conditions=groups)  
+     # assign treatment for each amount of randomly sampled numbers and add as column
+     listoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], sampled_numbers[x]) 
+     # add column of amount of sampled numbers
+     listoflists[[q]][[x]]$repeats <- rep(repeats, sampled_numbers[x]) 
+     # add column of repeats made
+     listoflists[[q]][[x]]$id <- 1:sampled_numbers[x]
+     # add column of continuous id (for blocking)
+       for(i in 1:repeats){
+         thirdlistoflists[[x]][[i]] <- assignment(block(listoflists[[q]][[x]], id.vars = "id", block.vars = names(listoflists[[q]][[x]])[i], n.tr = length(groups)))
+         # block and assign samples to treatment groups
+         fourthlistoflists[[x]][[i]] <- list(cbind(rep(sampled_numbers[x], sampled_numbers[x]/length(groups)), thirdlistoflists[[x]][[i]]$assg[[1]]$`Max Distance`))
+         # bind levels of sampled_numbers with equivalent group diffs
+         for(z in 1:length(groups)){
+           secondlistoflists[[q]][[x]][i,z] <- mean(listoflists[[q]][[x]][,i][listoflists[[q]][[x]]$groups == levels(groups)[z]]) 
+           # take means of each treatment group and add to dataframe
+         }
+         secondlistoflists[[q]][[x]][i,(length(groups)+1)] <- var(listoflists[[q]][[x]][,i]) 
+         # take variance of each repeat and add to dataframe
+         secondlistoflists[[q]][[x]][i,(length(groups)+2)] <- lev[q] 
+         # add levels used to dataframe
+       }  
+     secondlistoflists[[q]][[x]]$groups <- rep(length(groups), repeats) 
+     secondlistoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], repeats)
+     secondlistoflists[[q]][[x]]$repeats <- rep(repeats, repeats)
+     }
+ }
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%> 
> list_all_samples <- unlist(listoflists, recursive=FALSE) 
> # turn listoflists (which is a list of lists of dataframes) into a list of dataframes
> list_all_means_variances <- unlist(secondlistoflists, recursive = FALSE) 
> # same for secondlistoflists
> all_samples <- ldply(list_all_samples, data.frame) 
> # turn the list of dataframes of all samples into one giant dataframe of all samples
> all_means_variances <- ldply(list_all_means_variances, data.frame) 
> # same for list of dataframes of all means and variances
> all_means_variances$diff <- apply(all_means_variances[,1:length(groups)], 1, function(x) diff(range(x)))
> # calculate the maximum diff between treatment groups
> all_means_variances$label <- c(rep("rand", nrow(all_means_variances)))
> # add the label "rand" to all rows (for plotting)
> list_all_blocked <- unlist(fourthlistoflists, recursive = FALSE) 
> # turn fourthlistoflists (which is a list of lists of dataframes) into a list of dataframes
> all_blocked <- ldply(list_all_blocked, data.frame)
> # turn the list of dataframes with all blocked diffs into one giant dataframe of all diffs
> colnames(all_blocked) <- c("sampled_numbers", "diff")
> all_blocked$label <- c(rep("blocked", nrow(all_blocked)))
> # add the label "blocked" to all rows (for plotting)
> 
> write.csv(all_samples, file = "all_samples_3.csv")
> write.csv(all_means_variances, file = "all_means_variances_3.csv")
> write.csv(all_blocked, file = "all_blocked_3.csv")
> 
> rm(list=ls())
> 
> 
> 
> ## Save .csv files for blocked and randomized ##
> ## Same as above, just for 5 groups
> 
> sampled_numbers <- seq(from = 15, to = 1000, by = 10)
> length(sampled_numbers)
[1] 99
> repeats <- 100
> lev <- 5
> groups <- as.factor(c("control", "treatment1", "treatment2", "treatment3", "treatment4"))
> listoflists <- rep(list(list()), length(lev)) # lists with with length(lev) # of lists
> 
> df <- data.frame(matrix(NA, repeats, (length(groups)+2))) 
> # +2 to add variance and levels columns after the treatment group columns
> colnames(df) <- c(levels(groups), "variance", "levels")
> secondlistofdfs <- rep(list(df), length(sampled_numbers)) # list with length(sampled_numbers) # of df
> secondlistoflists <- rep(list(secondlistofdfs), length(lev)) # list with length(lev) # of secondlistofdfs
> thirdlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> fourthlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> 
> pb <- txtProgressBar(min = 1, max = length(sampled_numbers), style = 3)
> 
> for(q in 1:length(lev)){
+   for(x in 1:length(sampled_numbers)){
+     setTxtProgressBar(pb, x)
+     listoflists[[q]][[x]] <- data.frame(replicate(repeats, sample(lev[q], sampled_numbers[x], replace = TRUE))) 
+     # randomly sample numbers
+     listoflists[[q]][[x]]$levels <- rep(lev[q], sampled_numbers[x]) 
+     # add column of levels used
+     listoflists[[q]][[x]]$groups <- simple_ra(N = sampled_numbers[x], conditions=groups)  
+     # assign treatment for each amount of randomly sampled numbers and add as column
+     listoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], sampled_numbers[x]) 
+     # add column of amount of sampled numbers
+     listoflists[[q]][[x]]$repeats <- rep(repeats, sampled_numbers[x]) 
+     # add column of repeats made
+     listoflists[[q]][[x]]$id <- 1:sampled_numbers[x]
+     # add column of continuous id (for blocking)
+       for(i in 1:repeats){
+         thirdlistoflists[[x]][[i]] <- assignment(block(listoflists[[q]][[x]], id.vars = "id", block.vars = names(listoflists[[q]][[x]])[i], n.tr = length(groups)))
+         # block and assign samples to treatment groups
+         fourthlistoflists[[x]][[i]] <- list(cbind(rep(sampled_numbers[x], sampled_numbers[x]/length(groups)), thirdlistoflists[[x]][[i]]$assg[[1]]$`Max Distance`))
+         # bind levels of sampled_numbers with equivalent group diffs
+         for(z in 1:length(groups)){
+           secondlistoflists[[q]][[x]][i,z] <- mean(listoflists[[q]][[x]][,i][listoflists[[q]][[x]]$groups == levels(groups)[z]]) 
+           # take means of each treatment group and add to dataframe
+         }
+         secondlistoflists[[q]][[x]][i,(length(groups)+1)] <- var(listoflists[[q]][[x]][,i]) 
+         # take variance of each repeat and add to dataframe
+         secondlistoflists[[q]][[x]][i,(length(groups)+2)] <- lev[q] 
+         # add levels used to dataframe
+       }  
+     secondlistoflists[[q]][[x]]$groups <- rep(length(groups), repeats) 
+     secondlistoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], repeats)
+     secondlistoflists[[q]][[x]]$repeats <- rep(repeats, repeats)
+     }
+ }
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%> 
> list_all_samples <- unlist(listoflists, recursive=FALSE) 
> # turn listoflists (which is a list of lists of dataframes) into a list of dataframes
> list_all_means_variances <- unlist(secondlistoflists, recursive = FALSE) 
> # same for secondlistoflists
> all_samples <- ldply(list_all_samples, data.frame) 
> # turn the list of dataframes of all samples into one giant dataframe of all samples
> all_means_variances <- ldply(list_all_means_variances, data.frame) 
> # same for list of dataframes of all means and variances
> all_means_variances$diff <- apply(all_means_variances[,1:length(groups)], 1, function(x) diff(range(x)))
> # calculate the maximum diff between treatment groups
> all_means_variances$label <- c(rep("rand", nrow(all_means_variances)))
> # add the label "rand" to all rows (for plotting)
> list_all_blocked <- unlist(fourthlistoflists, recursive = FALSE) 
> # turn fourthlistoflists (which is a list of lists of dataframes) into a list of dataframes
> all_blocked <- ldply(list_all_blocked, data.frame)
> # turn the list of dataframes with all blocked diffs into one giant dataframe of all diffs
> colnames(all_blocked) <- c("sampled_numbers", "diff")
> all_blocked$label <- c(rep("blocked", nrow(all_blocked)))
> # add the label "blocked" to all rows (for plotting)
> 
> write.csv(all_samples, file = "all_samples_5.csv")
> write.csv(all_means_variances, file = "all_means_variances_5.csv")
> write.csv(all_blocked, file = "all_blocked_5.csv")
> 
> rm(list=ls())
> 
> 
> 
> ## Save .csv files for blocked and randomized ##
> ## Same as above, just for 10 groups
> 
> sampled_numbers <- seq(from = 30, to = 1000, by = 10)
> length(sampled_numbers)
[1] 98
> repeats <- 100
> lev <- 5
> groups <- as.factor(c("control", "treatment1", "treatment2", "treatment3", "treatment4", "treatment5", "treatment6", "treatment7", "treatment8", "treatment9"))
> listoflists <- rep(list(list()), length(lev)) # lists with with length(lev) # of lists
> 
> df <- data.frame(matrix(NA, repeats, (length(groups)+2))) 
> # +2 to add variance and levels columns after the treatment group columns
> colnames(df) <- c(levels(groups), "variance", "levels")
> secondlistofdfs <- rep(list(df), length(sampled_numbers)) # list with length(sampled_numbers) # of df
> secondlistoflists <- rep(list(secondlistofdfs), length(lev)) # list with length(lev) # of secondlistofdfs
> thirdlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> fourthlistoflists <- rep(list(list()), length(sampled_numbers)) # list with length(sampled_numers) # of lists
> 
> pb <- txtProgressBar(min = 1, max = length(sampled_numbers), style = 3)
> 
> for(q in 1:length(lev)){
+   for(x in 1:length(sampled_numbers)){
+     setTxtProgressBar(pb, x)
+     listoflists[[q]][[x]] <- data.frame(replicate(repeats, sample(lev[q], sampled_numbers[x], replace = TRUE))) 
+     # randomly sample numbers
+     listoflists[[q]][[x]]$levels <- rep(lev[q], sampled_numbers[x]) 
+     # add column of levels used
+     listoflists[[q]][[x]]$groups <- simple_ra(N = sampled_numbers[x], conditions=groups)  
+     # assign treatment for each amount of randomly sampled numbers and add as column
+     listoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], sampled_numbers[x]) 
+     # add column of amount of sampled numbers
+     listoflists[[q]][[x]]$repeats <- rep(repeats, sampled_numbers[x]) 
+     # add column of repeats made
+     listoflists[[q]][[x]]$id <- 1:sampled_numbers[x]
+     # add column of continuous id (for blocking)
+       for(i in 1:repeats){
+         thirdlistoflists[[x]][[i]] <- assignment(block(listoflists[[q]][[x]], id.vars = "id", block.vars = names(listoflists[[q]][[x]])[i], n.tr = length(groups)))
+         # block and assign samples to treatment groups
+         fourthlistoflists[[x]][[i]] <- list(cbind(rep(sampled_numbers[x], sampled_numbers[x]/length(groups)), thirdlistoflists[[x]][[i]]$assg[[1]]$`Max Distance`))
+         # bind levels of sampled_numbers with equivalent group diffs
+         for(z in 1:length(groups)){
+           secondlistoflists[[q]][[x]][i,z] <- mean(listoflists[[q]][[x]][,i][listoflists[[q]][[x]]$groups == levels(groups)[z]]) 
+           # take means of each treatment group and add to dataframe
+         }
+         secondlistoflists[[q]][[x]][i,(length(groups)+1)] <- var(listoflists[[q]][[x]][,i]) 
+         # take variance of each repeat and add to dataframe
+         secondlistoflists[[q]][[x]][i,(length(groups)+2)] <- lev[q] 
+         # add levels used to dataframe
+       }  
+     secondlistoflists[[q]][[x]]$groups <- rep(length(groups), repeats) 
+     secondlistoflists[[q]][[x]]$sampled_numbers <- rep(sampled_numbers[x], repeats)
+     secondlistoflists[[q]][[x]]$repeats <- rep(repeats, repeats)
+     }
+ }
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%> 
> list_all_samples <- unlist(listoflists, recursive=FALSE) 
> # turn listoflists (which is a list of lists of dataframes) into a list of dataframes
> list_all_means_variances <- unlist(secondlistoflists, recursive = FALSE) 
> # same for secondlistoflists
> all_samples <- ldply(list_all_samples, data.frame) 
> # turn the list of dataframes of all samples into one giant dataframe of all samples
> all_means_variances <- ldply(list_all_means_variances, data.frame) 
> # same for list of dataframes of all means and variances
> all_means_variances$diff <- apply(all_means_variances[,1:length(groups)], 1, function(x) diff(range(x)))
> all_means_variances$label <- c(rep("rand", nrow(all_means_variances)))
> # add the label "rand" to all rows (for plotting)
> # calculate the maximum diff between treatment groups
> list_all_blocked <- unlist(fourthlistoflists, recursive = FALSE) 
> # turn fourthlistoflists (which is a list of lists of dataframes) into a list of dataframes
> all_blocked <- ldply(list_all_blocked, data.frame)
> # turn the list of dataframes with all blocked diffs into one giant dataframe of all diffs
> colnames(all_blocked) <- c("sampled_numbers", "diff")
> all_blocked$label <- c(rep("blocked", nrow(all_blocked)))
> # add the label "blocked" to all rows (for plotting)
> 
> write.csv(all_samples, file = "all_samples_10.csv")
> write.csv(all_means_variances, file = "all_means_variances_10.csv")
> write.csv(all_blocked, file = "all_blocked_10.csv")
> 
> rm(list=ls())
> 
> 
> proc.time()
    user   system  elapsed 
141922.0  37154.1 179101.9 
