---
title: |
  | Improving Precision in Survey Experiments
  | &mdash;
  | A New Method to Use Ordinal Variables for Blocking
author: |
  | Simon Heuberger
  | 6 March 2019
header-includes:
   - \usepackage{bm}
titlegraphic: /Users/simonheuberger/Dropbox/work/logo.png
fontsize: 10pt
output:
  beamer_presentation:
    template: /Users/simonheuberger/Dropbox/work/markdown_templates/beamer_template_svm_conferences.tex
  slide_level: 1
bibliography: /Users/simonheuberger/Dropbox/work/bib-files/all-together.bib
---

```{r Global Options, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
thresholds <- read.csv("data/thresholds.csv")
```


# Outline

* Basics of survey experiments
* Basics of blocking
* Basics of ordinal variables
* Method:
    + Machine learning through Ordered Probit Model (OPM)
    + Blocking
    + Ordinal variable: Education
* Setup of eventual `R` package


\pdfnote{What I am not doing:}
\pdfnote{-- Inventing blocking}
\pdfnote{-- Inventing estimation techniques for ordinal variables}
\pdfnote{What I am doing:}
\pdfnote{-- Combining estimation techniques for ordinal variables with blocking}
\pdfnote{-- Ordered Probit Model (OPM) + blocking}



# Survey Experiments

* Collect demographics and contain questions with some type of treatment
* Created to uncover effect of treatment on public opinion and/or behavior
* Example: "A disease breaks out in the US."
    + Treatment group 1: "With Program A, 200 out of 600 people will live."
    + Treatment group 2: "With Program A, 400 out of 600 people will die."
    + "Do you support or oppose program A?"
* Results usually estimated with OLS regression
* DV is respondents' answer to treatment question; EVs are demographics
* Crucial for (internally) valid results: Balance
    + Randomization, i.e. flip a coin
    + More advanced: Blocking

\pdfnote{Balance = groups need to be comparable} 
\pdfnote{Groups need to look the same on every measure}
\pdfnote{Otherwise we can't trace any effect back to treatment}
\pdfnote{}
\pdfnote{}
<!-- Empty \pdfnote{} moves the comment a bit up the page. Otherwise it's at the very bottom -->


# Blocking

* Using covariates to create pre-assignment groups ("blocks") of similar units
    + Unit similarity estimated with Mahalanobis or Euclidian distance
* Randomization takes place within blocks
* Ensures an equal proportion of treated and untreated units
* Can improve precision of causal estimates over randomization
* Most crucially: Guarantees balance
    + Especially relevant with small samples
    + Especially relevant with high number of treatment groups

\pdfnote{Robust to unlucky randomizations}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/__all_boxplots.pdf}

\pdfnote{Differences in means are statistically significant}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/__all_histograms.pdf}

\pdfnote{Blocking is all about covariates/variables. There are many different types}
\pdfnote{Most pol sci predictive variables are categorical variables}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# Categorical Variables

* Data that can be divided into groups
* Nominal: No intrinsic ordering
    + Gender, Race, Occupation, Party ID
    + Often used as binary variables
* Interval: Ordered, evenly spaced
    + Income
    + Often made numeric
* Ordinal: Ordered, not evenly spaced 
    + Education
    + Often made numeric
    
\pdfnote{The last one is problematic}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# Ordinal Variables

* Example for an important ordinal variable: Education
* Education levels: "Elementary school", "Some high school", "HS grad", "Some college", "College grad"
* Previous plots simulated by assigning interval: 1, 2, 3, 4, 5
    + Arbitrary
    + Not based on any data-driven reasons
* Much better: Estimate underlying latent continuous structure
    + Machine Learning: Ordered Probit Model

\pdfnote{Does 1:5 really represent the spacing between the categories?}
\pdfnote{It makes sense for evenly spaced income categories, but here?}
\pdfnote{Maybe the spacing between some categories is so narrow they shouldn't}
\pdfnote{even be separate categories?}
\pdfnote{}

				  		
# Ordered Probit Model (OPM) Theory 

* $\exists\; \bm{X}$, an $n \times k$ matrix of explanatory variables
* $\bm{Y}$ observed on ordered categories: $\bm{Y}_i \in [1,\ldots,k]$, for $i=1,\ldots n$
* $\bm{Y}$ assumed to be produced by unobserved latent continuous variable $\bm{Y^*}$
* $\bm{Y^*}$ is continuous from $-\infty$ to $\infty$
* $\bm{Y^*} = \bm{X}_i \bm{\beta} + e_i, e_i \sim N(0,1), \forall i = 1,...,N$
* Linear model creates numerical thresholds: 
    $\bm{Y^*}_i: \;
              \delta_0 \underset{c=1}{\longleftarrow\!\longrightarrow}
            	\delta_1 \underset{c=2}{\longleftarrow\!\longrightarrow}
            	\delta_2 \underset{c=3}{\longleftarrow\!\longrightarrow}
            	\delta_3\ldots
            	\delta_{C-1} \underset{c=C}{\longleftarrow\!\longrightarrow}
            	\delta_C$
* Thresholds partition variable into regions corresponding to ordinal categories
* Linear model bins observations between thresholds according to the EVs

\pdfnote{$e_i$ is an error term with standard normal distribution}
\pdfnote{$Y$ assumed ... is THE central idea behind OPM}
\pdfnote{$Y^* =$ ... is a linear combination of meaningful covariates}
\pdfnote{Next slide: What does this mean in plain English?}
\pdfnote{}


# OPM in Plain English

* Find an externally and internally valid data set
* Train model on data with education as DV and meaningful covariates as EVs
* This model:
    + Estimates cutoff thresholds between categories
    + Bins data cases according to linear predictors
    + Binned cases determine which variable categories make sense

\pdfnote{Next slide: Apply this model to education}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# OPM for Education

* Data: ANES 2016

* Model: $Education \sim Gender + Race + Age + Income + Occupation + Party ID$

\pdfnote{Next slide: The original education categories looked like this}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/barplot_orig.pdf}

\pdfnote{Based on these categories, the model estimated}
\pdfnote{thresholds and coefficients}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

```{r results='asis', echo=FALSE}
stargazer(thresholds, summary = FALSE, rownames = FALSE, header=FALSE, align = TRUE, title = "Ordered Probit Threshold Estimates", label = "thresholds")
```

<!--
This commented out code shows the thresholds/coefficients plot with error bars. People in the March 6 presentation found it confusing because it seemed to imply the categories were good (because there was no overlap), but the new education categories barplot shows they were collapsed. So I'm taking it out for now.

\pdfnote{Next slide: Everyone prefers a plot over a table}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/thresholds.pdf}
-->
\pdfnote{Observations in the data are binned according to coefficients}
\pdfnote{Binned cases determine what categories make sense}
\pdfnote{}
\pdfnote{}
\pdfnote{}



# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/barplot_new.pdf}

\pdfnote{Once I showed original plot: What do we do with OPM results?}
\pdfnote{}
\pdfnote{}
\pdfnote{}
\pdfnote{}


# 

\vspace{0.2cm}
\centering
\includegraphics[scale=0.5]{figs/barplot_orig.pdf}


# Using OPM Results to Block on Education

* OPM results:
    + Are not arbitrary
    + Are data-based
    + Use ordinal information whilst respecting uneven spaces
* Assigning numerical values to the new categories is now justifiable
* Block on numerical values the same way as before
    + \texttt{blockTools} with Mahalanobis distance
* Difference between OPM and interval method:
    + OPM gives us categories that make sense given the data
    + Interval method without any modelling has no empirical justification
* OPM uses the ordinal information to create categories that fit the data
* Through OPM, we can block whilst fully utilizing the ordinal information
* This was not possible before


# Eventual `R` Package

* Loads trained model 
* Applies trained categories to education variable
* Blocks on trained categories (`blockTools`)
* In addition: \href{https://sheuberger.shinyapps.io/survey_experiment/}{Online application}

\pdfnote{The model does not have to be retrained by each user}
\pdfnote{Sequentially means assigning people as they trickle in, rather than all at once}
\pdfnote{Because it's a relatively new feature, quick showing of R survey environment}
\pdfnote{Overall: New method to use ordinal information for blocking}
\pdfnote{Overall: New open-source online incorporation of method}





# 

\centering \LARGE \textcolor{pigmentblue}{Thank you!}





