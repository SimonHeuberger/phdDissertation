\appendix

# BLOCKING {#app-ordblock}

## Online Experiment Environment {#app-ordblock-env}

In order to conduct this experiment, I created an online survey environment based on `R` with `shiny` [@boas_fielding_2013], as there currently is no available tool to block sequentially online. Popular online survey platforms, such as Qualtrics, do not offer this functionality, and none of the attempts to combine `R` code work with Qualtrics concern the 'injection' of `R` code into the Qualtrics randomization engine, which blocking would require [@hainmueller_2014_causal;@barari_2017_package;@testa_2017_qualtricstools;@ginn_2018_package]. The following is a basic outline of the mechanisms behind this survey environment.

The survey questions, i.e. questions that collect demographic information and questions that apply treatment, need to be designed as `.txt` files and incorporated into a local `shiny` environment. This local environment is then hosted in the cloud and publicly accessible. The hosted website sequentially blocks each incoming respondent based on her covariate information and covariate information from all previous respondents through constant interaction with the `R` code. The workflow for any incoming respondent is illustrated in Figure \ref{online-workflow} below.

\vspace{0.8cm}

\begin{figure}[ht]
\centering
\begin{tikzpicture}
    \node [cloud]  (survey) {\scriptsize{P starts survey}};
    \node [cloud, below right=0.8cm and -0.6cm of survey] (dems) {\scriptsize{P answers demographics}};
    \node [cloud, right= 0.2cm of survey] (pulls) {\scriptsize{Pull data from Dropbox}};
    \node [cloud, below right=0.8cm and -0.3cm of pulls] (blocking) {\scriptsize{Blocking}};
    \node [cloud, right= 0.2cm of pulls] (assignment) {\scriptsize{Assignment}};
    \node [cloud, below right=0.8cm and -0.6cm of assignment] (treatment) {\scriptsize{Treatment}};
    \node [cloud, right= 0.2cm of assignment] (results) {\scriptsize{Save data to Dropbox}};
	\path [line] (survey) -- (dems);
	\path [line] (dems) -- (pulls);
	\path [line] (pulls) -- (blocking);
	\path [line] (blocking) -- (assignment);
	\path [line] (assignment) -- (treatment);
	\path [line] (treatment) -- (results);
\end{tikzpicture}
\caption{Online Survey Experiment Workflow} \label{online-workflow}
\end{figure}

A respondent clicks on the survey link and answers the demographic question. After she selects her level of education, `R` code in the background pulls previous respondents' covariate information from a Dropbox server. Based on this information and her chosen education level, the `R` code sequentially blocks and assigns her to a treatment group. The respondent then sees and answers the respective treatment question(s). Her responses are then saved on the same Dropbox server. This process is repeated for all incoming respondents. If the respondent is the first person to take the survey, i.e. if there is no covariate information from previous respondents yet, the code randomly assigns her to one of the treatment groups. All subsequent respondents are then blocked and assigned as just described. To recruit respondents, the website was fed into Lucid's marketplace. 



## Blocking Differences {#app-ordblock-blockdiff}

```{r Block-ANES-OP-Categories-Table, include=FALSE}

df.all.table <- df.all # I need the columns numeric for the plot, but I want the leading zero dropped for the table
# I might not need the table, but I don't want to throw it away

tab <- stargazer(df.all, 
                 summary = FALSE,
                 header=FALSE,
                 align = TRUE,
                 title = "Variable Proportions/Means After Blocking ANES Data on ANES and OP Education Categories. Differentiated by Treatment Group",
                 label = "education-blocked")
st <- gsub("{c}", "{l}", tab, fixed = TRUE)
cat(st)

```

```{r Block-ANES-OP-Categories-Figure, include=FALSE}

for(i in 1:ncol(df.all)){
  df.all[,i] <- as.numeric(df.all[,i])
}

df.all <- tibble::rownames_to_column(df.all, "categories") # turn row names into column
df.all$categories <- as.factor(df.all$categories)
df.all <- df.all[,c(1:3, 1, 4, 5, 1, 6, 7)] # repeat the categories column so I can loop over everything
col.n <- c("categories", "ANES", "OP")
iters <- c(1, 1+n.tr, 1+n.tr*2) # it needs to go 1, 2, 3, then 4, 5, 6, then 7, 8, 9. So we need the numbers 1, 4, 7 as i for the loop
blocked.plots <- list()

for(i in iters){
  group <- df.all[,c(i, i+1, i+2)]
  colnames(group) <- col.n
  
  gender <- group[1:3,]
  gender$variable <- rep("Gender", 3) %>% as.factor
  gender.melt <- melt(gender, variable.name = "group")
  
  race <- group[4:8,]
  race$variable <- rep("Race", 5) %>% as.factor
  race.melt <- melt(race, variable.name = "group")
  
  income <- group[9:16,]
  income$categories <- c("<25k", "25-50k", "50-75k", "75-100k", "100-125k", "125-150k", "150-175k", ">175K") %>% factor
  income$variable <- rep("Income", 8) %>% as.factor
  income.melt <- melt(income, variable.name = "group")
  
  empl <- group[17:22,]
  empl$variable <- rep("Employment", 6) %>% as.factor
  empl.melt <- melt(empl, variable.name = "group")
  
  pid <- group[23:26,]
  pid$variable <- rep("Party ID", 4) %>% as.factor
  pid.melt <- melt(pid, variable.name = "group")
  
  pres <- group[27:28,]
  pres$variable <- rep("President", 2) %>% as.factor
  pres.melt <- melt(pres, variable.name = "group")
  
  minw <- group[29:32,]
  minw$variable <- rep("Minimum Wage", 4) %>% as.factor
  minw.melt <- melt(minw, variable.name = "group")
  
  country <- group[33:34,]
  country$variable <- rep("Country", 2) %>% as.factor
  country.melt <- melt(country, variable.name = "group")
  
  age <- group[35,]
  age$variable <- rep("Age", 1) %>% as.factor
  age.melt <- melt(age, variable.name = "group")
  
  feel <- group[36,]
  feel$variable <- rep("Feel Trump", 1) %>% as.factor
  feel.melt <- melt(feel, variable.name = "group")
  
  p.gender <- ggplot(data = gender.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Gender") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.race <- ggplot(data = race.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Race") + 
    theme(axis.title.y=element_blank(), legend.position = c(0.4, 0.7), axis.text.x = element_text(angle = 45)) + 
    guides(fill=guide_legend(title="Categories"))
  p.empl <- ggplot(data = empl.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Employment") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.pid <- ggplot(data = pid.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Party ID") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.age <- ggplot(data = age.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Age") + 
    theme(axis.title.y=element_blank(), legend.position='none',
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank())
  
  p.income <- ggplot(data = income.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Income") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.pres <- ggplot(data = pres.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("President") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.minw <- ggplot(data = minw.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Minimum Wage") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.country <- ggplot(data = country.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Country") + 
    theme(axis.title.y=element_blank(), legend.position='none', axis.text.x = element_text(angle = 45))
  p.feel <- ggplot(data = feel.melt, aes(x = categories, y = value)) +
    geom_bar(aes(fill = group), stat = "identity", position = "dodge") + xlab("Feel Trump") + 
    theme(axis.title.y=element_blank(), legend.position='none',
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank())
  
  blocked.plots[[i]] <- list(p.gender, p.race, p.empl, p.pid, p.age, 
                             p.income, p.pres, p.minw, p.country, p.feel)
}

blocked.plots <- blocked.plots[lengths(blocked.plots) != 0] # to remove null elements from list

```


Figures \ref{ANBlock1} to \ref{ANBlock3} show the variable proportions or means, depending on the type of variable in question, after blocking the ANES data on education into three treatment groups. As outlined above, this is done twice, once based on the original ANES education categories, and once based on the newly estimated OP education categories.


```{r ANES-Blocked-Plot-1, echo=FALSE, fig.width=10, fig.height=6, fig.cap="Variable Proportions/Means After Blocking ANES Data on ANES and OP Education Categories, Treatment Group 1. `Age` and `Feel Trump` Show Means, All Others Show Proportions.\\label{ANBlock1}"}

grid.arrange(grobs = blocked.plots[[1]], ncol = 5, nrow = 2)

```

```{r ANES-Blocked-Plot-2, echo=FALSE, fig.width=10, fig.height=6, fig.cap="Variable Proportions/Means After Blocking ANES Data on ANES and OP Education Categories, Treatment Group 2. `Age` and `Feel Trump` Show Means, All Others Show Proportions.\\label{ANBlock2}"}

grid.arrange(grobs = blocked.plots[[2]], ncol = 5, nrow = 2)

```

```{r ANES-Blocked-Plot-3, echo=FALSE, fig.width=10, fig.height=6, fig.cap="Variable Proportions/Means After Blocking ANES Data on ANES and OP Education Categories, Treatment Group 3. `Age` and `Feel Trump` Show Means, All Others Show Proportions.\\label{ANBlock3}"}

grid.arrange(grobs = blocked.plots[[3]], ncol = 5, nrow = 2)

```







# MISSING DATA {#app-ordmiss}


## Imputing Missing Data for All ANES and CCES Observations {#app-ordmiss-allObs}

While using the full number of observations in the ANES data is possible, doing so for the CCES data provides great computational challenges. All 2,395 ANES observations can be used for 1,000 multiple imputation iterations. With over 42,000 observations, however, the number of iterations that are computationally feasible for the CCES data is reduced to 10. Anything above that maxes out the 120 GB RAM on the cloud container that was at my disposal, which results in termination of the code. Keeping these restrictions in mind, Tables \ref{mar.5var.all} and \ref{mnar.5var.all} show the results for MAR and MNAR for 5 variables with inserted missing data.


```{r MAR 5 Variables All Observations, include=FALSE}

mar.5var.anes.all <- read.csv("data/anes/appendix/anes.mar.results.5var.2395n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mar.5var.cces.all <- read.csv("data/cces/appendix/cces.mar.results.5var.42205n.10it.20perc.csv") %>% .[,-1] %>% addPlus

mar.5var.anes.all[1:6, 2] <- mar.5var.cces.all[1:6, 2] <- rep("Democrat", 6)
mar.5var.anes.all[19:24, 2] <- mar.5var.cces.all[19:24, 2] <- rep("Income", 6)

mar.5var.anes.all$diff[mar.5var.anes.all$method == "true"] <- mar.5var.anes.all$value[mar.5var.anes.all$method == "true"]
mar.5var.cces.all$diff[mar.5var.cces.all$method == "true"] <- mar.5var.cces.all$value[mar.5var.cces.all$method == "true"]

levels(mar.5var.anes.all$method) <- levels(mar.5var.cces.all$method) <-
  levs

mar.5var.all <- cbind(mar.5var.anes.all[, c(1,2,4)], mar.5var.cces.all[,4])

for(i in 1:ncol(mar.5var.all)){
  mar.5var.all[,i] <- mar.5var.all[,i] %>% as.character
}

mar.5var.all <- rbind(mar.5var.all, c("Observations", "", 2395, 42205), c("Iterations", "", 1000, 10))
colnames(mar.5var.all) <- col.names[-5]

tab.mar.5var.all <- stargazer(mar.5var.all, 
                              summary = FALSE,
                              align = TRUE,
                              header = FALSE,
                              rownames = FALSE,
                              title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, MAR, 5 Variables with NA, All Observations",
                              label = "mar.5var.all")

kt <- gsub("\\multicolumn{1}{c}{", "", tab.mar.5var.all, fixed = TRUE)
cat(kt)

```



 \begin{table}[!htbp] \centering    
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, MAR, 5 Variables with NA, All Observations}  
 \label{mar.5var.all}
\begin{tabular}{ccr@{}lr@{}l} 
 \\[-1.8ex]\hline 
 \hline \\[-1.8ex]
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex] 
 true & Democrat & 0.&3370 & 0.&4032 \\
 hd.ord & Democrat & --0.&0001 & + 0.&0006 \\
 hot.deck & Democrat & --0.&0002 & + 0.&0006 \\ 
 amelia & Democrat & + 0.&0000 & + 0.&0003 \\
 mice & Democrat & + 0.&0000 & + 0.&0003 \\
 na.omit & Democrat & --0.&0302 & --0.&0250 \\
 true & Male & 0.&4868 & 0.&4521 \\
 hd.ord & Male & --0.&0004 & --0.&0001 \\ 
 hot.deck & Male & --0.&0008 & --0.&0002 \\
 amelia & Male & + 0.&0001 & + 0.&0001 \\
 mice & Male & + 0.&0001 & + 0.&0001 \\
 na.omit & Male & --0.&0365 & --0.&0436 \\
 true & Interest & 2.&8806 & 3.&3301 \\
 hd.ord & Interest & --0.&0087 & --0.&0033 \\
 hot.deck & Interest & --0.&0135 & --0.&0046 \\
 amelia & Interest & + 0.&0001 & + 0.&0001 \\
 mice & Interest & + 0.&0000 & + 0.&0000 \\ 
 na.omit & Interest & --0.&0741 & --0.&0763 \\
 true & Income & 16.&6894 & 6.&5830 \\
 hd.ord & Income & --0.&0606 & --0.&0009 \\ 
 hot.deck & Income & --0.&1030 & --0.&0073 \\
 amelia & Income & + 0.&0009 & --0.&0021 \\
 mice & Income & --0.&0007 & --0.&0022 \\
 na.omit & Income & --0.&5574 & --0.&2592 \\
 true & Age & 50.&3745 & 52.&8639 \\
 hd.ord & Age & --0.&2355 & --0.&0221 \\ 
 hot.deck & Age & --0.&3698 & --0.&0790 \\ 
 amelia & Age & + 0.&0056 & --0.&0006 \\
 mice & Age & + 0.&0053 & --0.&0132 \\
 na.omit & Age & --1.&2785 & --1.&2190 \\
 \hline \\[-1.8ex] 
\multicolumn{2}{c}{Observations} & \multicolumn{2}{c}{2395} & \multicolumn{2}{c}{42205} \\ 
\multicolumn{2}{c}{Iterations} & \multicolumn{2}{c}{1000} & \multicolumn{2}{c}{10} \\ 
\hline \\[-1.8ex] 
 \end{tabular} 
 \end{table} 




```{r MNAR 5 Variables All Observations, include=FALSE}

mnar.5var.anes.all <- read.csv("data/anes/appendix/anes.mnar.results.5var.2395n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mnar.5var.cces.all <- read.csv("data/cces/appendix/cces.mnar.results.5var.42205n.10it.20perc.csv") %>% .[,-1] %>% addPlus

mnar.5var.anes.all[1:6, 2] <- mnar.5var.cces.all[1:6, 2] <- rep("Democrat", 6)
mnar.5var.anes.all[19:24, 2] <- mnar.5var.cces.all[19:24, 2] <- rep("Income", 6)

mnar.5var.anes.all$diff[mnar.5var.anes.all$method == "true"] <- mnar.5var.anes.all$value[mnar.5var.anes.all$method == "true"]
mnar.5var.cces.all$diff[mnar.5var.cces.all$method == "true"] <- mnar.5var.cces.all$value[mnar.5var.cces.all$method == "true"]

levels(mnar.5var.anes.all$method) <- levels(mnar.5var.cces.all$method) <-
  levs

mnar.5var.all <- cbind(mnar.5var.anes.all[, c(1,2,4)], mnar.5var.cces.all[,4])

for(i in 1:ncol(mnar.5var.all)){
  mnar.5var.all[,i] <- mnar.5var.all[,i] %>% as.character
}

mnar.5var.all <- rbind(mnar.5var.all, c("Observations", "", 2395, 42205), c("Iterations", "", 1000, 10))
colnames(mnar.5var.all) <- col.names[-5]

tab.mnar.5var.all <- stargazer(mnar.5var.all, 
                               summary = FALSE,
                               align = TRUE,
                               header = FALSE,
                               rownames = FALSE,
                               title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, MNAR, 5 Variables with NA, All Observations",
                               label = "mnar.5var.all")

lt <- gsub("\\multicolumn{1}{c}{", "", tab.mnar.5var.all, fixed = TRUE)
cat(lt)

```


 \begin{table}[!htbp] \centering   
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, MNAR, 5 Variables with NA, All Observations}   
 \label{mnar.5var.all}  
\begin{tabular}{ccr@{}lr@{}l} 
 \\[-1.8ex]\hline 
 \hline \\[-1.8ex] 
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex]  
 true & Democrat & 0.&3370 & 0.&4032 \\ 
 hd.ord & Democrat & --0.&0109 & --0.&0105 \\
 hot.deck & Democrat & --0.&0113 & --0.&0105 \\
 amelia & Democrat & --0.&0110 & --0.&0109 \\
 mice & Democrat & --0.&0103 & --0.&0106 \\
 na.omit & Democrat & --0.&0185 & --0.&0145 \\  
 true & Male & 0.&4868 & 0.&4521 \\ 
 hd.ord & Male & --0.&0138 & --0.&0129 \\ 
 hot.deck & Male & --0.&0136 & --0.&0131 \\ 
 amelia & Male & --0.&0134 & --0.&0132 \\
 mice & Male & --0.&0134 & --0.&0131 \\ 
 na.omit & Male & --0.&0196 & --0.&0244 \\ 
 true & Interest & 2.&8806 & 3.&3301 \\
 hd.ord & Interest & --0.&0257 & --0.&0171 \\
 hot.deck & Interest & --0.&0299 & --0.&0179 \\
 amelia & Interest & --0.&0178 & --0.&0147 \\
 mice & Interest & --0.&0179 & --0.&0148 \\
 na.omit & Interest & --0.&0407 & --0.&0418 \\
 true & Income & 16.&6894 & 6.&5830 \\
 hd.ord & Income & --0.&1874 & --0.&0691 \\ 
 hot.deck & Income & --0.&2287 & --0.&0696 \\
 amelia & Income & --0.&1292 & --0.&0637 \\
 mice & Income & --0.&1297 & --0.&0634 \\
 na.omit & Income & --0.&2729 & --0.&1375 \\
 true & Age & 50.&3745 & 52.&8639 \\ 
 hd.ord & Age & --0.&5240 & --0.&2331 \\
 hot.deck & Age & --0.&6609 & --0.&2764 \\
 amelia & Age & --0.&2533 & --0.&2342 \\
 mice & Age & --0.&2474 & --0.&2371 \\
 na.omit & Age & --0.&7188 & --0.&6476 \\
\hline \\[-1.8ex] 
\multicolumn{2}{c}{Observations} & \multicolumn{2}{c}{2395} & \multicolumn{2}{c}{42205} \\ 
\multicolumn{2}{c}{Iterations} & \multicolumn{2}{c}{1000} & \multicolumn{2}{c}{10} \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table} 
 







\clearpage 


## Imputing 12 Variables with Missing Data {#app-ordmiss-12var}

```{r MAR 12 Variables, include=FALSE}

mar.12var.anes <- read.csv("data/anes/mar/results/anes.mar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mar.12var.cces <- read.csv("data/cces/mar/results/cces.mar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
# mar.12var.frame<- read.csv("data/framing/mar/results/framing.mar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus

mar.12var.anes[1:6, 2] <- mar.12var.cces[1:6, 2] <- rep("Democrat", 6)
mar.12var.anes[19:24, 2] <- mar.12var.cces[19:24, 2] <- rep("Income", 6)
mar.12var.anes[37:42, 2] <- mar.12var.cces[37:42, 2] <- rep("Employed", 6)

mar.12var.anes$diff[mar.12var.anes$method == "true"] <- mar.12var.anes$value[mar.12var.anes$method == "true"]
mar.12var.cces$diff[mar.12var.cces$method == "true"] <- mar.12var.cces$value[mar.12var.cces$method == "true"]
# mar.12var.frame$diff[mar.12var.frame$method == "true"] <- mar.12var.frame$value[mar.12var.frame$method == "true"]

levels(mar.12var.anes$method) <- levels(mar.12var.cces$method) <- levs
# levels(mar.12var.frame$method) <-levs

un.meth <- mar.12var.anes$method %>% unique
un.meth.len <- un.meth %>% length
un.vars <- c(mar.12var.anes$variable %>% as.character,
             mar.12var.cces$variable %>% as.character) %>%
  unique
# un.vars <- c(mar.12var.anes$variable %>% as.character,
#                  mar.12var.cces$variable %>% as.character, 
#                  mar.12var.frame$variable %>% as.character) %>%
#   unique
un.vars.len <- un.vars %>% length
un.anes.len <- mar.12var.anes$variable %>% unique %>% length
un.cces.var <- mar.12var.cces$variable %>% unique %>% as.character
un.cces.len <- un.cces.var %>% length
# un.frame.var <- mar.12var.frame$variable %>% unique %>% as.character
# un.frame.len <- un.frame.var %>% length
Variable <- rep(un.vars, each = un.meth.len)
Method <- rep(un.meth, un.vars.len) %>% as.character
meth.len <- Method %>% length

mar.12var <- cbind(Method, Variable) %>% as.data.frame

mar.12var$mar.anes.col <- c(mar.12var.anes$diff, 
                            rep("---", 
                                un.meth.len * (un.vars.len - un.anes.len)))
mar.12var$mar.cces.col <- rep("---", meth.len) %>% as.character
# mar.12var$mar.frame.col <- rep("---", meth.len) %>% as.character

for(i in 1:(un.cces.len)){
  mar.12var$mar.cces.col[mar.12var$Variable == un.cces.var[i]] <- mar.12var.cces$diff[mar.12var.cces$variable == un.cces.var[i]]
  # mar.12var$mar.frame.col[mar.12var$Variable == un.frame.var[i]] <- mar.12var.frame$diff[mar.12var.frame$variable == un.frame.var[i]]
}

colnames(mar.12var) <- col.names

# to make the in-text citations shorter
mar.12.anes <- mar.12var$ANES
mar.12.cces <- mar.12var$CCES
# mar.12.frame <- mar.12var$Framing
mar.12.meth <- mar.12var$Method
mar.12.var <- mar.12var$Variable

tab.mar.12var <- stargazer(mar.12var, 
                           summary = FALSE,
                           align = TRUE,
                           header = FALSE,
                           rownames = FALSE,
                           digits = 4,
                           title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, MAR, 12 Variables with NA",
                           label = "mar.12var")

mt <- gsub("\\multicolumn{1}{c}{", "", tab.mar.12var, fixed = TRUE)
cat(mt)


```


Table \ref{mar.12var} shows the results of imputing both data sets MAR for 12 amputed variables. The first five listed variables are the same as for the MAR analysis for five amputed variables in Table \ref{mar.5var}. The remaining variables were chosen based on availability in each data set. As much as possible, the same variables were selected across both data sets. `Black`, `Employed`, `Religious`, `Married`, `OwnHome`, `Rally`, `Donate`, `Gay`, `StudLoans`, `Hispanic`, `Official`, and `Student` are binary variables. `Black` indicates whether a respondent is of African-American origin, `Employed` whether she is currently employed, `Religious` whether she follows a religious belief, `Married` whether she is currently married, `OwnHome` whether she owns her home, `Rally` whether she has attended a political rally, `Donate` whether she has donated to a political candidate, `Gay` whether she identifies as homosexual, `StudLoans` whether she currently has student loans, `Hispanic` whether she is of Hispanic origin, `Official` whether she has contacted her political representative, and `Student` whether she currently is a student. `Media` is an ordinal variable and indicates how much she follows public affairs in the media (scaled from 1 to 5). `Participation` is an interval variable and shows the accumulative count of political activities she has participated in (scaled from 0 to 4).

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, MAR, 12 Variables with NA}   
 \label{mar.12var} 
 \\[-1.8ex]\hline 
 \hline \\[-1.8ex] 
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex] 
 true & Democrat & 0.&3420 & 0.&3770 \\ 
 hd.ord & Democrat & --0.&0005 & --0.&0003 \\
 hot.deck & Democrat & --0.&0005 & --0.&0004 \\
 amelia & Democrat & + 0.&0000 & + 0.&0000 \\
 mice & Democrat & + 0.&0000 & + 0.&0001 \\
 na.omit & Democrat & --0.&0191 & --0.&0172 \\
 true & Male & 0.&4890 & 0.&4830 \\ 
 hd.ord & Male & --0.&0004 & --0.&0002 \\
 hot.deck & Male & --0.&0001 & --0.&0003 \\  
 amelia & Male & + 0.&0001 & --0.&0001 \\
 mice & Male & + 0.&0000 & --0.&0002 \\
 na.omit & Male & --0.&0256 & --0.&0364 \\
 true & Interest & 2.&9340 & 3.&3290 \\
 hd.ord & Interest & --0.&0053 & --0.&0041 \\
 hot.deck & Interest & --0.&0077 & --0.&0067 \\
 amelia & Interest & + 0.&0001 & --0.&0001 \\
 mice & Interest & + 0.&0000 & --0.&0001 \\ 
 na.omit & Interest & --0.&0620 & --0.&0515 \\
 true & Income & 16.&6140 & 6.&4810 \\ 
 hd.ord & Income & --0.&0470 & --0.&0130 \\ 
 hot.deck & Income & --0.&0591 & --0.&0212 \\
 amelia & Income & --0.&0007 & --0.&0005 \\
 mice & Income & --0.&0013 & --0.&0003 \\ 
 na.omit & Income & --0.&6303 & --0.&2860 \\
 true & Age & 50.&0410 & 52.&8230 \\
 hd.ord & Age & --0.&1391 & --0.&0883 \\ 
 hot.deck & Age & --0.&1835 & --0.&1435 \\
 amelia & Age & + 0.&0056 & --0.&0015 \\ 
 mice & Age & + 0.&0048 & --0.&0050 \\ 
 na.omit & Age & --0.&8638 & --0.&5974 \\
 true & Black & 0.&0790 & 0.&0950 \\ 
 hd.ord & Black & + 0.&0000 & + 0.&0000 \\
 hot.deck & Black & + 0.&0000 & + 0.&0000 \\ 
 amelia & Black & + 0.&0000 & + 0.&0001 \\
 mice & Black & + 0.&0000 & + 0.&0001 \\ 
 na.omit & Black & --0.&0092 & --0.&0090 \\
 true & Employed & 0.&6610 & 0.&4370 \\ 
 hd.ord & Employed & + 0.&0006 & + 0.&0000 \\ 
 hot.deck & Employed & + 0.&0006 & + 0.&0001 \\
 amelia & Employed & + 0.&0000 & + 0.&0000 \\
 mice & Employed & + 0.&0000 & --0.&0001 \\
 na.omit & Employed & --0.&0087 & --0.&0301 \\
 true & Religious & 0.&6460 & 0.&6420 \\ 
 hd.ord & Religious & --0.&0006 & --0.&0003 \\ 
 hot.deck & Religious & --0.&0005 & --0.&0003 \\
 amelia & Religious & --0.&0001 & --0.&0001 \\
 mice & Religious & --0.&0001 & --0.&0002 \\ 
 na.omit & Religious & --0.&0166 & --0.&0234 \\ 
 true & Married & 0.&5290 & 0.&6310 \\
 hd.ord & Married & + 0.&0002 & --0.&0001 \\
 hot.deck & Married & + 0.&0002 & + 0.&0001 \\
 amelia & Married & --0.&0001 & --0.&0002 \\
 mice & Married & --0.&0001 & --0.&0002 \\ 
 na.omit & Married & --0.&0384 & --0.&0326 \\ 
 true & OwnHome & 0.&6820 & 0.&7010 \\
 hd.ord & OwnHome & --0.&0001 & --0.&0002 \\ 
 hot.deck & OwnHome & + 0.&0000 & + 0.&0000 \\ 
 amelia & OwnHome & + 0.&0001 & + 0.&0000 \\ 
 mice & OwnHome & --0.&0001 & --0.&0001 \\
 na.omit & OwnHome & --0.&0334 & --0.&0304 \\
 true & Rally & 0.&0830 & --- \\
 hd.ord & Rally & --0.&0001 & --- \\ 
 hot.deck & Rally & --0.&0002 & --- \\ 
 amelia & Rally & + 0.&0001 & --- \\ 
 mice & Rally & + 0.&0001 & --- \\ 
 na.omit & Rally & --0.&0191 & --- \\ 
 true & Donate & 0.&1390 & --- \\ 
 hd.ord & Donate & --0.&0002 & --- \\ 
 hot.deck & Donate & --0.&0005 & --- \\
 amelia & Donate & + 0.&0000 & --- \\ 
 mice & Donate & + 0.&0001 & --- \\ 
 na.omit & Donate & --0.&0320 & --- \\ 
 true & Gay & \multicolumn{2}{l}{---} & 0.&0420 \\ 
 hd.ord & Gay & \multicolumn{2}{l}{---}  & + 0.&0001 \\
 hot.deck & Gay & \multicolumn{2}{l}{---} & + 0.&0000 \\ 
 amelia & Gay & \multicolumn{2}{l}{---} & + 0.&0000 \\
 mice & Gay & \multicolumn{2}{l}{---} & + 0.&0000 \\
 na.omit & Gay & \multicolumn{2}{l}{---} &  --0.&0112 \\
 true & StudLoans & \multicolumn{2}{l}{---} & 0.&1910 \\
 hd.ord & StudLoans & \multicolumn{2}{l}{---} & + 0.&0003 \\
 hot.deck & StudLoans & \multicolumn{2}{l}{---} & + 0.&0002 \\
 amelia & StudLoans & \multicolumn{2}{l}{---} & + 0.&0000 \\
 mice & StudLoans & \multicolumn{2}{l}{---} & --0.&0001 \\
 na.omit & StudLoans & \multicolumn{2}{l}{---} & --0.&0117 \\ 
 \hline \\[-1.8ex]
 \end{longtable}

\dsp

\normalsize

The results are consistent with those presented in Table \ref{mar.5var}. For the binary variables, `amelia` and `mice` again perform best with results actually matching the true variable values, though `hd.ord` arguably shows closer results than in Table \ref{mar.5var} with a maximum difference to a true value of `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Employed"]` (ANES `Employed`). For the ordinal variable, `hd.ord` continues to perform worst across both data sets. `mice` and `amelia` again show the best results. Note, however, that `hd.ord` is less worse in terms of performance differences when compared to the MAR analysis of five imputed variables. The maximum difference to the true `Interest` value is `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Interest"]` (ANES) for 12 variables but `r mar.5.anes[mar.12.meth == "hd.ord" & mar.12.var == "Interest"]` (ANES) for five variables. This is possibly explained by a thinner spread of missing values across a higher number of variables, resulting in a lower number of NAs in each amputed variable. 

The results for the interval variables follow the same pattern: `hd.ord` displays the worst results for both data sets. The difference to `hot.deck` is still present though less pronounced than in the MAR analysis of five imputed variables. `mice` overall performs better than `amelia` for `Income` and `Age`, with the exceptions of ANES `Income` (`r mar.12.anes[mar.12.meth == "amelia" & mar.12.var == "Income"]` vs. `r mar.12.anes[mar.12.meth == "mice" & mar.12.var == "Income"]`) and CCES `Age` (`r mar.12.cces[mar.12.meth == "amelia" & mar.12.var == "Age"]` vs. `r mar.12.cces[mar.12.meth == "mice" & mar.12.var == "Age"]`).


```{r MNAR 12 Variables, include=FALSE}

mnar.12var.anes <- read.csv("data/anes/mnar/results/anes.mnar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mnar.12var.cces <- read.csv("data/cces/mnar/results/cces.mnar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
# mnar.12var.frame <- read.csv("data/framing/mnar/results/framing.mnar.results.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus

mnar.12var.anes[1:6, 2] <- mnar.12var.cces[1:6, 2] <- rep("Democrat", 6)
mnar.12var.anes[19:24, 2] <- mnar.12var.cces[19:24, 2] <- rep("Income", 6)
mnar.12var.anes[37:42, 2] <- mnar.12var.cces[37:42, 2] <- rep("Employed", 6)

mnar.12var.anes$diff[mnar.12var.anes$method == "true"] <- mnar.12var.anes$value[mnar.12var.anes$method == "true"]
mnar.12var.cces$diff[mnar.12var.cces$method == "true"] <- mnar.12var.cces$value[mnar.12var.cces$method == "true"]
# mnar.12var.frame$diff[mnar.12var.frame$method == "true"] <- mnar.12var.frame$value[mnar.12var.frame$method == "true"]

levels(mnar.12var.anes$method) <- levels(mnar.12var.cces$method) <- levs
# levels(mnar.12var.frame$method) <- levs

# there are several in-between code steps that are identical to MAR 12 Variables
# above, so I didn't include them here

mnar.12var <- cbind(Method, Variable) %>% as.data.frame

mnar.12var$mnar.anes.col <- c(mnar.12var.anes$diff,
                              rep("---",
                                  un.meth.len * (un.vars.len - un.anes.len)))
mnar.12var$mnar.cces.col <- rep("---", meth.len) %>% as.character
# mnar.12var$mnar.frame.col <- rep("---", meth.len) %>% as.character

for(i in 1:(un.cces.len)){
  mnar.12var$mnar.cces.col[mnar.12var$Variable == un.cces.var[i]] <- mnar.12var.cces$diff[mnar.12var.cces$variable == un.cces.var[i]]
  # mnar.12var$mnar.frame.col[mnar.12var$Variable == un.frame.var[i]] <- mnar.12var.frame$diff[mnar.12var.frame$variable == un.frame.var[i]]
}

colnames(mnar.12var) <- col.names

# to make the in-text citations shorter
mnar.12.anes <- mnar.12var$ANES
mnar.12.cces <- mnar.12var$CCES
# mnar.12.frame <- mnar.12var$Framing
mnar.12.meth <- mnar.12var$Method
mnar.12.var <- mnar.12var$Variable

tab.mnar.12var <- stargazer(mnar.12var,
                            summary = FALSE,
                            align = TRUE,
                            header = FALSE,
                            rownames = FALSE,
                            digits = 4,
                            title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, MNAR, 12 Variables with NA",
                            label = "mnar.12var")

nt <- gsub("\\multicolumn{1}{c}{", "", tab.mnar.12var, fixed = TRUE)
cat(nt)


```


Table \ref{mnar.12var} shows the results of imputing both data sets MNAR for 12 amputed variables. The results are consistent with those obtained for five amputed variables MNAR. `amelia` and `mice` perform better than `hd.ord` for the binary variables overall, but often not by much. Occasionally, `hd.ord` eclipses them (`r mnar.12.anes[mnar.12.meth == "hd.ord" & mnar.12.var == "Male"]` vs. `r mnar.12.anes[mnar.12.meth == "mice" & mnar.12.var == "Male"]` `mice` and `amelia` ANES `Male`). `na.omit` once more performs close to the other methods.

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, MNAR, 12 Variables with NA}  
 \label{mnar.12var} 
 \\[-1.8ex]\hline 
 \hline \\[-1.8ex]
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex] 
 true & Democrat & 0.&3420 & 0.&3770 \\
 hd.ord & Democrat & --0.&0049 & --0.&0046 \\
 hot.deck & Democrat & --0.&0049 & --0.&0049 \\
 amelia & Democrat & --0.&0043 & --0.&0045 \\
 mice & Democrat & --0.&0040 & --0.&0044 \\ 
 na.omit & Democrat & --0.&0092 & --0.&0081 \\
 true & Male & 0.&4890 & 0.&4830 \\ 
 hd.ord & Male & --0.&0055 & --0.&0049 \\ 
 hot.deck & Male & --0.&0053 & --0.&0051 \\ 
 amelia & Male & --0.&0055 & --0.&0050 \\
 mice & Male & --0.&0055 & --0.&0049 \\
 na.omit & Male & --0.&0093 & --0.&0119 \\ 
 true & Interest & 2.&9340 & 3.&3290 \\
 hd.ord & Interest & --0.&0113 & --0.&0090 \\ 
 hot.deck & Interest & --0.&0134 & --0.&0113 \\
 amelia & Interest & --0.&0068 & --0.&0061 \\
 mice & Interest & --0.&0068 & --0.&0061 \\
 na.omit & Interest & --0.&0236 & --0.&0161 \\ 
 true & Income & 16.&6140 & 6.&4810 \\ 
 hd.ord & Income & --0.&0899 & --0.&0350 \\ 
 hot.deck & Income & --0.&1046 & --0.&0421 \\
 amelia & Income & --0.&0495 & --0.&0223 \\
 mice & Income & --0.&0503 & --0.&0218 \\ 
 na.omit & Income & --0.&2088 & --0.&0970 \\
 true & Age & 50.&0410 & 52.&8230 \\ 
 hd.ord & Age & --0.&2571 & --0.&1732 \\ 
 hot.deck & Age & --0.&3081 & --0.&2251 \\
 amelia & Age & --0.&1100 & --0.&1014 \\ 
 mice & Age & --0.&1047 & --0.&0986 \\ 
 na.omit & Age & --0.&3397 & --0.&1367 \\
 true & Black & 0.&0790 & 0.&0950 \\
 hd.ord & Black & --0.&0035 & --0.&0038 \\
 hot.deck & Black & --0.&0037 & --0.&0038 \\ 
 amelia & Black & --0.&0037 & --0.&0040 \\ 
 mice & Black & --0.&0034 & --0.&0038 \\
 na.omit & Black & --0.&0045 & --0.&0052 \\
 true & Employed & 0.&6610 & 0.&4370 \\
 hd.ord & Employed & --0.&0034 & --0.&0053 \\
 hot.deck & Employed & --0.&0033 & --0.&0053 \\
 amelia & Employed & --0.&0031 & --0.&0040 \\
 mice & Employed & --0.&0031 & --0.&0040 \\ 
 na.omit & Employed & --0.&0014 & --0.&0111 \\ 
 true & Religious & 0.&6460 & 0.&6420 \\ 
 hd.ord & Religious & --0.&0045 & --0.&0039 \\
 hot.deck & Religious & --0.&0043 & --0.&0038 \\
 amelia & Religious & --0.&0040 & --0.&0040 \\
 mice & Religious & --0.&0040 & --0.&0040 \\ 
 na.omit & Religious & --0.&0049 & --0.&0073 \\ 
 true & Married & 0.&5290 & 0.&6310 \\ 
 hd.ord & Married & --0.&0041 & --0.&0038 \\
 hot.deck & Married & --0.&0040 & --0.&0037 \\ 
 amelia & Married & --0.&0042 & --0.&0037 \\ 
 mice & Married & --0.&0042 & --0.&0037 \\ 
 na.omit & Married & --0.&0122 & --0.&0096 \\ 
 true & OwnHome & 0.&6820 & 0.&7010 \\ 
 hd.ord & OwnHome & --0.&0030 & --0.&0030 \\ 
 hot.deck & OwnHome & --0.&0028 & --0.&0027 \\
 amelia & OwnHome & --0.&0027 & --0.&0030 \\ 
 mice & OwnHome & --0.&0027 & --0.&0030 \\ 
 na.omit & OwnHome & --0.&0111 & --0.&0090 \\
 true & Rally & 0.&0830 & --- \\ 
 hd.ord & Rally & --0.&0043 & --- \\ 
 hot.deck & Rally & --0.&0042 & --- \\ 
 amelia & Rally & --0.&0040 & --- \\ 
 mice & Rally & --0.&0039 & --- \\ 
 na.omit & Rally & --0.&0077 & --- \\  
 true & Donate & 0.&1390 & --- \\ 
 hd.ord & Donate & --0.&0051 & --- \\ 
 hot.deck & Donate & --0.&0054 & --- \\ 
 amelia & Donate & --0.&0049 & --- \\ 
 mice & Donate & --0.&0048 & --- \\ 
 na.omit & Donate & --0.&0122 & --- \\ 
 true & Gay & \multicolumn{2}{l}{---} & 0.&0420 \\ 
 hd.ord & Gay & \multicolumn{2}{l}{---} & --0.&0024 \\ 
 hot.deck & Gay & \multicolumn{2}{l}{---} & --0.&0025 \\ 
 amelia & Gay & \multicolumn{2}{l}{---} & --0.&0026 \\
 mice & Gay & \multicolumn{2}{l}{---} & --0.&0024 \\ 
 na.omit & Gay & \multicolumn{2}{l}{---} & --0.&0035 \\ 
 true & StudLoans & \multicolumn{2}{l}{---} & 0.&1910 \\
 hd.ord & StudLoans & \multicolumn{2}{l}{---} & --0.&0058 \\
 hot.deck & StudLoans & \multicolumn{2}{l}{---} & --0.&0058 \\ 
 amelia & StudLoans & \multicolumn{2}{l}{---} & --0.&0051 \\ 
 mice & StudLoans & \multicolumn{2}{l}{---} & --0.&0050 \\ 
 na.omit & StudLoans & \multicolumn{2}{l}{---} & --0.&0070 \\ 
 \hline \\[-1.8ex]
 \end{longtable} 
 
 \dsp

\normalsize

For the ordinal variable, `hd.ord` shows the worst performance across both data sets. `mice` and `amelia` perform far better and display virtually identical results. `na.omit` does not perform as well as in the corresponding MAR analysis. `mice` and `amelia`'s superior performance is also visible in the results for the ordinal variables. `na.omit` performs better than `hot.deck` and `hd.ord` for CCES `Age` (`r mnar.12.cces[mnar.12.meth == "na.omit" & mnar.12.var == "Age"]` vs. `r mnar.12.cces[mnar.12.meth == "hot.deck" & mnar.12.var == "Age"]` and `r mnar.12.cces[mnar.12.meth == "hd.ord" & mnar.12.var == "Age"]`). 



## Imputing 11 Variables with Missing Data for Two Ordinal Variables {#app-ordmiss-mult-11var}

```{r MULT MAR 11 Variables, include=FALSE}

mult.mar.11var.anes <- read.csv("data/anes/mar/results/anes.mar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mult.mar.11var.cces <- read.csv("data/cces/mar/results/cces.mar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
# mult.mar.11var.frame <- read.csv("data/framing/mar/results/framing.mar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus

mult.mar.11var.anes[1:6, 2] <- mult.mar.11var.cces[1:6, 2] <- rep("Democrat", 6)
mult.mar.11var.anes[13:18, 2] <- mult.mar.11var.cces[13:18, 2] <- rep("Income", 6)
mult.mar.11var.anes[31:36, 2] <- mult.mar.11var.cces[31:36, 2] <- rep("Employed", 6)

mult.mar.11var.anes$diff[mult.mar.11var.anes$method == "true"] <- mult.mar.11var.anes$value[mult.mar.11var.anes$method == "true"]
mult.mar.11var.cces$diff[mult.mar.11var.cces$method == "true"] <- mult.mar.11var.cces$value[mult.mar.11var.cces$method == "true"]
# mult.mar.11var.frame$diff[mult.mar.11var.frame$method == "true"] <- mult.mar.11var.frame$value[mult.mar.11var.frame$method == "true"]

levels(mult.mar.11var.anes$method) <- levels(mult.mar.11var.cces$method) <- levs
# levels(mult.mar.11var.frame$method) <- levs


mult.un.meth <- mult.mar.11var.anes$method %>% unique
mult.un.meth.len <- mult.un.meth %>% length
mult.un.vars <- c(mult.mar.11var.anes$variable %>% as.character,
                  mult.mar.11var.cces$variable %>% as.character) %>%
  unique
# mult.un.vars <- c(mult.mar.11var.anes$variable %>% as.character,
#                   mult.mar.11var.cces$variable %>% as.character,
#                   mult.mar.11var.frame$variable %>% as.character) %>%
#   unique
mult.un.vars.len <- mult.un.vars %>% length
mult.un.anes.len <- mult.mar.11var.anes$variable %>% unique %>% length
mult.un.cces.var <- mult.mar.11var.cces$variable %>% unique %>% as.character
mult.un.cces.len <- mult.un.cces.var %>% length
# mult.un.frame.var <- mult.mar.11var.frame$variable %>% unique %>% as.character
# mult.un.frame.len <- mult.un.frame.var %>% length

mult.variable <- rep(mult.un.vars, each = mult.un.meth.len)
mult.method <- rep(mult.un.meth, mult.un.vars.len) %>% as.character
mult.meth.len <- mult.method %>% length

mult.mar.11var <- cbind(mult.method, mult.variable) %>% as.data.frame

mult.mar.11var$mult.anes.col <- c(mult.mar.11var.anes$diff,
                                  rep("---",
                                      mult.un.meth.len * (mult.un.vars.len - mult.un.anes.len)))
mult.mar.11var$mult.cces.col <- rep("---", mult.meth.len) %>% as.character
# mult.mar.11var$mult.frame.col <- rep("---", mult.meth.len) %>% as.character

for(i in 1:(mult.un.cces.len)){
  mult.mar.11var$mult.cces.col[mult.mar.11var$mult.variable == mult.un.cces.var[i]] <- mult.mar.11var.cces$diff[mult.mar.11var.cces$variable == mult.un.cces.var[i]]
  # mult.mar.11var$mult.frame.col[mult.mar.11var$mult.variable == mult.un.frame.var[i]] <- mult.mar.11var.frame$diff[mult.mar.11var.frame$variable == mult.un.frame.var[i]]
}

colnames(mult.mar.11var) <- col.names

# to make the in-text citations shorter
mult.mar.11.anes <- mult.mar.11var$ANES
mult.mar.11.cces <- mult.mar.11var$CCES
# mult.mar.11.frame <- mult.mar.11var$Framing
mult.mar.11.meth <- mult.mar.11var$Method
mult.mar.11.var <- mult.mar.11var$Variable

tab.mult.mar.11var <- stargazer(mult.mar.11var, 
                                summary = FALSE,
                                align = TRUE,
                                header = FALSE,
                                rownames = FALSE,
                                digits = 4,
                                title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, 2 Ordinal Variables (Education, Interest), MAR, 11 Variables with NA",
                                label = "mult.mar.11var")

ot <- gsub("\\multicolumn{1}{c}{", "", tab.mult.mar.11var, fixed = TRUE)
cat(ot)

```


Table \ref{mult.mar.11var} shows the results of imputing both data sets with two `polr`-treated variables MAR for 11 amputed variables. A similar picture for Table \ref{mult.mar.4var} emerges for the binary variables, with `amelia` and `mice` once more displaying the best results, though `hd.ord` appears to perform somewhat closer here. Consistent with the deterioration of `hd.ord` results from Table \ref{mar.5var} to Table \ref{mult.mar.4var}, `hd.ord` again consistently performs slightly worse when compared to the MAR analysis with 12 amputed variables and only `Education` treated by `polr`: `r mult.mar.11.anes[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Democrat"]`, `r mult.mar.11.cces[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Democrat"]` vs. `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Democrat"]`, `r mar.12.cces[mar.12.meth == "hd.ord" & mar.12.var == "Democrat"]` for `Democrat` and `r mult.mar.11.anes[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Male"]`, `r mult.mar.11.cces[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Male"]` vs. `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Male"]`, `r mar.12.cces[mar.12.meth == "hd.ord" & mar.12.var == "Male"]` for `Male`.

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, 2 Ordinal Variables (Education, Interest), MAR, 11 Variables with NA} 
 \label{mult.mar.11var}  
 \\[-1.8ex]\hline 
 \hline \\[-1.8ex]
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex]
 true & Democrat & 0.&3420 & 0.&3770 \\ 
 hd.ord & Democrat & --0.&0002 & --0.&0004 \\ 
 hot.deck & Democrat & --0.&0005 & --0.&0005 \\ 
 amelia & Democrat & + 0.&0000 & --0.&0001 \\ 
 mice & Democrat & + 0.&0000 & + 0.&0000 \\ 
 na.omit & Democrat & --0.&0200 & --0.&0213 \\
 true & Male & 0.&4890 & 0.&4830 \\ 
 hd.ord & Male & --0.&0002 & --0.&0005 \\
 hot.deck & Male & --0.&0001 & --0.&0004 \\
 amelia & Male & + 0.&0000 & --0.&0001 \\
 mice & Male & + 0.&0000 & --0.&0001 \\ 
 na.omit & Male & --0.&0254 & --0.&0350 \\ 
 true & Income & 16.&6140 & 6.&4810 \\ 
 hd.ord & Income & --0.&0346 & --0.&0114 \\
 hot.deck & Income & --0.&0657 & --0.&0241 \\ 
 amelia & Income & --0.&0018 & --0.&0007 \\
 mice & Income & --0.&0027 & --0.&0005 \\
 na.omit & Income & --0.&6432 & --0.&2888 \\
 true & Age & 50.&0410 & 52.&8230 \\ 
 hd.ord & Age & --0.&0887 & --0.&0704 \\
 hot.deck & Age & --0.&1951 & --0.&1532 \\
 amelia & Age & + 0.&0010 & --0.&0021 \\
 mice & Age & --0.&0016 & --0.&0055 \\ 
 na.omit & Age & --0.&8025 & --0.&4330 \\
 true & Black & 0.&0790 & 0.&0950 \\
 hd.ord & Black & + 0.&0001 & --0.&0001 \\
 hot.deck & Black & + 0.&0000 & --0.&0001 \\
 amelia & Black & + 0.&0000 & + 0.&0001 \\ 
 mice & Black & + 0.&0001 & + 0.&0001 \\ 
 na.omit & Black & --0.&0103 & --0.&0122 \\ 
 true & Employed & 0.&6610 & 0.&4370 \\
 hd.ord & Employed & + 0.&0007 & + 0.&0003 \\
 hot.deck & Employed & + 0.&0008 & + 0.&0001 \\ 
 amelia & Employed & + 0.&0001 & + 0.&0000 \\
 mice & Employed & + 0.&0001 & --0.&0001 \\
 na.omit & Employed & --0.&0109 & --0.&0328 \\
 true & Religious & 0.&6460 & 0.&6420 \\ 
 hd.ord & Religious & --0.&0001 & --0.&0002 \\ 
 hot.deck & Religious & --0.&0005 & --0.&0003 \\ 
 amelia & Religious & + 0.&0000 & --0.&0001 \\
 mice & Religious & + 0.&0000 & --0.&0002 \\
 na.omit & Religious & --0.&0174 & --0.&0241 \\ 
 true & Married & 0.&5290 & 0.&6310 \\ 
 hd.ord & Married & --0.&0001 & --0.&0002 \\ 
 hot.deck & Married & + 0.&0003 & + 0.&0001 \\ 
 amelia & Married & --0.&0001 & --0.&0002 \\ 
 mice & Married & --0.&0001 & --0.&0002 \\ 
 na.omit & Married & --0.&0390 & --0.&0324 \\ 
 true & OwnHome & 0.&6820 & 0.&7010 \\ 
 hd.ord & OwnHome & --0.&0005 & --0.&0001 \\
 hot.deck & OwnHome & --0.&0001 & + 0.&0002 \\ 
 amelia & OwnHome & + 0.&0000 & + 0.&0001 \\
 mice & OwnHome & --0.&0001 & + 0.&0000 \\
 na.omit & OwnHome & --0.&0341 & --0.&0295 \\
 true & Rally & 0.&0830 & --- \\ 
 hd.ord & Rally & + 0.&0000 & --- \\ 
 hot.deck & Rally & --0.&0002 & --- \\
 amelia & Rally & + 0.&0001 & --- \\ 
 mice & Rally & + 0.&0002 & --- \\
 na.omit & Rally & --0.&0186 & --- \\ 
 true & Donate & 0.&1390 & --- \\ 
 hd.ord & Donate & --0.&0003 & --- \\ 
 hot.deck & Donate & --0.&0007 & --- \\
 amelia & Donate & --0.&0001 & --- \\
 mice & Donate & + 0.&0000 & --- \\ 
 na.omit & Donate & --0.&0310 & --- \\ 
 true & Gay & \multicolumn{2}{l}{---} & 0.&0420 \\ 
 hd.ord & Gay & \multicolumn{2}{l}{---} & + 0.&0001 \\ 
 hot.deck & Gay & \multicolumn{2}{l}{---} & + 0.&0000 \\ 
 amelia & Gay & \multicolumn{2}{l}{---} & + 0.&0000 \\ 
 mice & Gay & \multicolumn{2}{l}{---} & + 0.&0001 \\
 na.omit & Gay & \multicolumn{2}{l}{---} & --0.&0113 \\ 
 true & StudLoans & \multicolumn{2}{l}{---} & 0.&1910 \\
 hd.ord & StudLoans & \multicolumn{2}{l}{---} & + 0.&0001 \\ 
 hot.deck & StudLoans & \multicolumn{2}{l}{---} & + 0.&0001 \\
 amelia & StudLoans & \multicolumn{2}{l}{---} & --0.&0001 \\ 
 mice & StudLoans & \multicolumn{2}{l}{---} & --0.&0001 \\ 
 na.omit & StudLoans & \multicolumn{2}{l}{---} & --0.&0146 \\
 \hline \\[-1.8ex] 
 \end{longtable}

\dsp

\normalsize

The same can be observed for the interval variables, with `hd.ord` again claiming last place across both data sets. The difference to `hot.deck` is still there but less pronounced than in Table \ref{mult.mar.4var}. `amelia` does best for `Age` while `mice` performs better for `Income`, with the exception of the ANES (`r mult.mar.11.anes[mult.mar.11.meth == "mice" & mult.mar.11.var == "Income"]` `mice` vs. `r mult.mar.11.anes[mult.mar.11.meth == "amelia" & mult.mar.11.var == "Income"]` `amelia`). As for the binary variables, `hd.ord` also consistently performs slightly worse when compared to the MAR analysis with 12 amputed variables and only `Education` treated by `polr`: `r mult.mar.11.anes[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Income"]`, `r mult.mar.11.cces[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Income"]` vs. `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Income"]`, `r mar.12.cces[mar.12.meth == "hd.ord" & mar.12.var == "Income"]` for `Income` and `r mult.mar.11.anes[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Age"]`, `r mult.mar.11.cces[mult.mar.11.meth == "hd.ord" & mult.mar.11.var == "Age"]` vs. `r mar.12.anes[mar.12.meth == "hd.ord" & mar.12.var == "Age"]`, `r mar.12.cces[mar.12.meth == "hd.ord" & mar.12.var == "Age"]` for `Age`.



```{r MULT MNAR 11 Variables, include=FALSE}

mult.mnar.11var.anes <- read.csv("data/anes/mnar/results/anes.mnar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
mult.mnar.11var.cces <- read.csv("data/cces/mnar/results/cces.mnar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus
# mult.mnar.11var.frame <- read.csv("data/framing/mnar/results/framing.mnar.mult.results.11var.1000n.1000it.20perc.csv") %>% .[,-1] %>% addPlus

mult.mnar.11var.anes[1:6, 2] <- mult.mnar.11var.cces[1:6, 2] <- rep("Democrat", 6)
mult.mnar.11var.anes[13:18, 2] <- mult.mnar.11var.cces[13:18, 2] <- rep("Income", 6)
mult.mnar.11var.anes[31:36, 2] <- mult.mnar.11var.cces[31:36, 2] <- rep("Employed", 6)

mult.mnar.11var.anes$diff[mult.mnar.11var.anes$method == "true"] <- mult.mnar.11var.anes$value[mult.mnar.11var.anes$method == "true"]
mult.mnar.11var.cces$diff[mult.mnar.11var.cces$method == "true"] <- mult.mnar.11var.cces$value[mult.mnar.11var.cces$method == "true"]
# mult.mnar.11var.frame$diff[mult.mnar.11var.frame$method == "true"] <- mult.mnar.11var.frame$value[mult.mnar.11var.frame$method == "true"]

levels(mult.mnar.11var.anes$method) <- levels(mult.mnar.11var.cces$method) <- levs
# levels(mult.mnar.11var.frame$method) <- levs

mult.un.meth <- mult.mnar.11var.anes$method %>% unique
mult.un.meth.len <- mult.un.meth %>% length
mult.un.vars <- c(mult.mnar.11var.anes$variable %>% as.character,
                  mult.mnar.11var.cces$variable %>% as.character) %>%
  unique
# mult.un.vars <- c(mult.mnar.11var.anes$variable %>% as.character,
#                   mult.mnar.11var.cces$variable %>% as.character,
#                   mult.mnar.11var.frame$variable %>% as.character) %>%
#   unique
mult.un.vars.len <- mult.un.vars %>% length
mult.un.anes.len <- mult.mnar.11var.anes$variable %>% unique %>% length
mult.un.cces.var <- mult.mnar.11var.cces$variable %>% unique %>% as.character
mult.un.cces.len <- mult.un.cces.var %>% length
# mult.un.frame.var <- mult.mnar.11var.frame$variable %>% unique %>% as.character
# mult.un.frame.len <- mult.un.frame.var %>% length

mult.variable <- rep(mult.un.vars, each = mult.un.meth.len)
mult.method <- rep(mult.un.meth, mult.un.vars.len) %>% as.character
mult.meth.len <- mult.method %>% length

mult.mnar.11var <- cbind(mult.method, mult.variable) %>% as.data.frame

mult.mnar.11var$mult.anes.col <- c(mult.mnar.11var.anes$diff,
                                  rep("---",
                                      mult.un.meth.len * (mult.un.vars.len - mult.un.anes.len)))
mult.mnar.11var$mult.cces.col <- rep("---", mult.meth.len) %>% as.character
# mult.mnar.11var$mult.frame.col <- rep("---", mult.meth.len) %>% as.character

for(i in 1:(mult.un.cces.len)){
  mult.mnar.11var$mult.cces.col[mult.mnar.11var$mult.variable == mult.un.cces.var[i]] <- mult.mnar.11var.cces$diff[mult.mnar.11var.cces$variable == mult.un.cces.var[i]]
  # mult.mnar.11var$mult.frame.col[mult.mnar.11var$mult.variable == mult.un.frame.var[i]] <- mult.mnar.11var.frame$diff[mult.mnar.11var.frame$variable == mult.un.frame.var[i]]
}

colnames(mult.mnar.11var) <- col.names

# to make the in-text citations shorter
mult.mnar.11.anes <- mult.mnar.11var$ANES
mult.mnar.11.cces <- mult.mnar.11var$CCES
# mult.mnar.11.frame <- mult.mnar.11var$Framing
mult.mnar.11.meth <- mult.mnar.11var$Method
mult.mnar.11.var <- mult.mnar.11var$Variable

tab.mult.mnar.11var <- stargazer(mult.mnar.11var, 
                                 summary = FALSE,
                                 align = TRUE,
                                 header = FALSE,
                                 rownames = FALSE,
                                 digits = 4,
                                 title = "Accuracy of Multiple Imputation Methods. ANES and CCES Data, 2 Ordinal Variables (Education, Interest), MNAR, 11 Variables with NA",
                                 label = "mult.mnar.11var")

pt <- gsub("\\multicolumn{1}{c}{", "", tab.mult.mnar.11var, fixed = TRUE)
cat(pt)


```


Table \ref{mult.mnar.11var} shows the results of imputing both data sets with two `polr`-treated variables MNAR for 11 amputed variables. For the binary variables, `amelia` and `mice` perform better, but often not by much. Occasionally, `hd.ord` eclipses them (`r mult.mnar.11.anes[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Male"]` `hd.ord` vs. `r mult.mnar.11.anes[mult.mnar.11.meth == "mice" & mult.mnar.11.var == "Male"]` `mice` ANES `Male`). As was the case in the comparison between the MNAR analysis with four amputed variables and the MNAR analysis with five amputed variables, `hd.ord` consistently demonstrates slightly worse results in the switch from 12 (Table \ref{mnar.12var}) to 11 and one to two `polr`-treated variables: `r mult.mnar.11.anes[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Democrat"]`, `r mult.mnar.11.cces[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Democrat"]` vs. `r mnar.12.anes[mnar.12.meth == "hd.ord" & mnar.12.var == "Democrat"]`, `r mnar.12.cces[mnar.12.meth == "hd.ord" & mnar.12.var == "Democrat"]` for `Democrat` and `r mult.mnar.11.anes[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Male"]`, `r mult.mnar.11.cces[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Male"]` vs. `r mnar.12.anes[mnar.12.meth == "hd.ord" & mnar.12.var == "Male"]`, `r mnar.12.cces[mnar.12.meth == "hd.ord" & mnar.12.var == "Male"]` for `Male`.

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. ANES and CCES Data, 2 Ordinal Variables (Education, Interest), MNAR, 11 Variables with NA}   
 \label{mult.mnar.11var}
 \\[-1.8ex]\hline  
 \hline \\[-1.8ex] 
 \multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{CCES} \\
 \hline \\[-1.8ex] 
 true & Democrat & 0.&3420 & 0.&3770 \\ 
 hd.ord & Democrat & --0.&0050 & --0.&0053 \\ 
 hot.deck & Democrat & --0.&0053 & --0.&0053 \\
 amelia & Democrat & --0.&0047 & --0.&0049 \\
 mice & Democrat & --0.&0044 & --0.&0048 \\ 
 na.omit & Democrat & --0.&0097 & --0.&0097 \\
 true & Male & 0.&4890 & 0.&4830 \\ 
 hd.ord & Male & --0.&0061 & --0.&0058 \\ 
 hot.deck & Male & --0.&0057 & --0.&0056 \\ 
 amelia & Male & --0.&0060 & --0.&0054 \\ 
 mice & Male & --0.&0060 & --0.&0054 \\ 
 na.omit & Male & --0.&0088 & --0.&0116 \\ 
 true & Income & 16.&6140 & 6.&4810 \\
 hd.ord & Income & --0.&0841 & --0.&0349 \\
 hot.deck & Income & --0.&1142 & --0.&0473 \\
 amelia & Income & --0.&0540 & --0.&0250 \\ 
 mice & Income & --0.&0549 & --0.&0249 \\ 
 na.omit & Income & --0.&2112 & --0.&0982 \\
 true & Age & 50.&0410 & 52.&8230 \\ 
 hd.ord & Age & --0.&2124 & --0.&1607 \\ 
 hot.deck & Age & --0.&3329 & --0.&2424 \\ 
 amelia & Age & --0.&1194 & --0.&1135 \\ 
 mice & Age & --0.&1141 & --0.&1102 \\ 
 na.omit & Age & --0.&2978 & --0.&0974 \\ 
 true & Black & 0.&0790 & 0.&0950 \\ 
 hd.ord & Black & --0.&0036 & --0.&0045 \\
 hot.deck & Black & --0.&0040 & --0.&0042 \\
 amelia & Black & --0.&0041 & --0.&0044 \\ 
 mice & Black & --0.&0037 & --0.&0041 \\ 
 na.omit & Black & --0.&0050 & --0.&0066 \\ 
 true & Employed & 0.&6610 & 0.&4370 \\ 
 hd.ord & Employed & --0.&0042 & --0.&0057 \\ 
 hot.deck & Employed & --0.&0036 & --0.&0058 \\ 
 amelia & Employed & --0.&0034 & --0.&0045 \\ 
 mice & Employed & --0.&0033 & --0.&0044 \\ 
 na.omit & Employed & --0.&0022 & --0.&0122 \\ 
 true & Religious & 0.&6460 & 0.&6420 \\
 hd.ord & Religious & --0.&0045 & --0.&0044 \\
 hot.deck & Religious & --0.&0047 & --0.&0042 \\
 amelia & Religious & --0.&0043 & --0.&0045 \\ 
 mice & Religious & --0.&0043 & --0.&0045 \\ 
 na.omit & Religious & --0.&0055 & --0.&0077 \\ 
 true & Married & 0.&5290 & 0.&6310 \\ 
 hd.ord & Married & --0.&0047 & --0.&0043 \\ 
 hot.deck & Married & --0.&0042 & --0.&0040 \\
 amelia & Married & --0.&0046 & --0.&0039 \\ 
 mice & Married & --0.&0045 & --0.&0039 \\ 
 na.omit & Married & --0.&0120 & --0.&0095 \\
 true & OwnHome & 0.&6820 & 0.&7010 \\
 hd.ord & OwnHome & --0.&0037 & --0.&0035 \\ 
 hot.deck & OwnHome & --0.&0030 & --0.&0030 \\
 amelia & OwnHome & --0.&0031 & --0.&0033 \\
 mice & OwnHome & --0.&0030 & --0.&0033 \\ 
 na.omit & OwnHome & --0.&0112 & --0.&0088 \\ 
 true & Rally & 0.&0830 & --- \\ 
 hd.ord & Rally & --0.&0047 & --- \\ 
 hot.deck & Rally & --0.&0047 & --- \\ 
 amelia & Rally & --0.&0045 & --- \\
 mice & Rally & --0.&0044 & --- \\
 na.omit & Rally & --0.&0080 & --- \\
 true & Donate & 0.&1390 & --- \\
 hd.ord & Donate & --0.&0057 & --- \\ 
 hot.deck & Donate & --0.&0060 & --- \\ 
 amelia & Donate & --0.&0054 & --- \\  
 mice & Donate & --0.&0053 & --- \\ 
 na.omit & Donate & --0.&0122 & --- \\ 
 true & Gay & \multicolumn{2}{l}{---} & 0.&0420 \\ 
 hd.ord & Gay & \multicolumn{2}{l}{---} & --0.&0027 \\
 hot.deck & Gay & \multicolumn{2}{l}{---} & --0.&0026 \\ 
 amelia & Gay & \multicolumn{2}{l}{---} & --0.&0028 \\ 
 mice & Gay & \multicolumn{2}{l}{---} & --0.&0027 \\ 
 na.omit & Gay & \multicolumn{2}{l}{---} & --0.&0037 \\
 true & StudLoans & \multicolumn{2}{l}{---} & 0.&1910 \\
 hd.ord & StudLoans & \multicolumn{2}{l}{---} & --0.&0067 \\
 hot.deck & StudLoans & \multicolumn{2}{l}{---} & --0.&0064 \\
 amelia & StudLoans & \multicolumn{2}{l}{---} & --0.&0057 \\
 mice & StudLoans & \multicolumn{2}{l}{---} & --0.&0056 \\ 
 na.omit & StudLoans & \multicolumn{2}{l}{---} & --0.&0082 \\
 \hline \\[-1.8ex] 
 \end{longtable}
 
\dsp

\normalsize

Finally, the results for the interval variables confirm previous results, with `amelia` and `mice` demonstrating the best performance. In addition, note that `na.omit` delivers better results than `hd.ord` for `Age` for both data sets and represents the best method for CCES `Age`. Similar to the MNAR results for four variables, the performance of `hd.ord` in the MNAR analysis of 11 variables deteriorates in the switch from one to two ordinal variables: `r mult.mnar.11.anes[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Income"]`, `r mult.mnar.11.cces[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Income"]` vs. `r mnar.12.anes[mnar.12.meth == "hd.ord" & mnar.12.var == "Income"]`, `r mnar.12.cces[mnar.12.meth == "hd.ord" & mnar.12.var == "Income"]` for `Income` and `r mult.mnar.11.anes[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Age"]`, `r mult.mnar.11.cces[mult.mnar.11.meth == "hd.ord" & mult.mnar.11.var == "Age"]` vs. `r mnar.12.anes[mnar.12.meth == "hd.ord" & mnar.12.var == "Age"]`, `r mnar.12.cces[mnar.12.meth == "hd.ord" & mnar.12.var == "Age"]` for `Age`.




## Speed for 12 Imputed Variables {#app-ordmiss-speed-12var}


```{r Runtimes 12 Variables MAR, include=FALSE}

run.12var.anes <- read.csv("data/anes/mar/runtimes/anes.mar.runtime.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% .[, order(ncol(.):1)]
run.12var.cces <- read.csv("data/cces/mar/runtimes/cces.mar.runtime.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% .[, order(ncol(.):1)]
# run.12var.frame <- read.csv("data/framing/mar/runtimes/framing.mar.runtime.12var.1000n.1000it.20perc.csv") %>% .[,-1] %>% .[, order(ncol(.):1)]

run.12var <- cbind(run.12var.anes, run.12var.cces[,2])
colnames(run.12var) <- c("", "ANES", "CCES")
```

```{r Runtimes Increased Missingness MAR 12 Variables Table, results='asis', echo=FALSE}

stargazer(run.12var,
          summary = FALSE,
          align = TRUE,
          header = FALSE,
          rownames = FALSE,
          title = "Runtimes of Multiple Imputation Methods (in Minutes). ANES and CCES Data, MAR, 12 Variables with NA",
          label = "runtimes12var")

```




# FRAMING {#app-framing}

## Framing Questionnaire {#app-framing-questionnaire}

\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire01.jpg}
  \caption{Questionnaire}
  \label{framing-questionnaire}
\end{figure}

\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire02.jpg}
\end{figure}

\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire03.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire04.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire05.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire06.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire07.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire08.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire09.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire10.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire11.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire12.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire13.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire14.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire15.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire16.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire17.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire18.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire19.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire20.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire21.jpg}
\end{figure}
\begin{figure}[hbt]
  \centering
\includegraphics{data/framing/appendix/questionnaire/questionnaire22.jpg}
\end{figure}

\clearpage 



## Survey Experiment Results Differentiated by Party ID {#app-framing-pid}

Tables \ref{exp-anes-op-rep} and \ref{exp-anes-op-dem} show the ordinal regression results differentiated by party ID. The `Moral Opposing` frames are stronger than the `Self-Interest Opposing` frames for Democrat ANES environment, Democrat OP environment, Democrat OP healthcare, and Republican ANES environment. Note that these results change, though, for Republican healthcare. Both the ANES and the OP `Self-Interest Opposing` frames move respondents more than their `Moral Opposing` counterparts. It thus appears that Republicans value self-interest more than morality when it comes to opposition to healthcare. As in the overall analysis above, the `Moral Supporting` frames do not move people more than the `Self-Interest Supporting` frames. All coefficients here include the null, with the exception of Democrat OP environment which actually shows a negative coefficient. Almost none of the control variables show statistically significant results. While the results for opposing frames for Republican healthcare are notable, these results nonetheless overall do not change the substantive conclusions for the hypotheses.


```{r Framing-Experiment-ANES-Republican, include=FALSE}

df.an.rep <- df.an %>% filter(., pid == "Republican")
vars.pid <- vars.op[!names(vars.op) %in% "Democrat"]

plr.out.an.rep.hc <- create.formula.plr.out(df.an.rep, vars.pid, "hc")
plr.out.an.rep.ev <- create.formula.plr.out(df.an.rep, vars.pid, "ev")

# adjust names (has to be done after tidy() because tidy() throws up an error otherwise)
names(plr.out.an.rep.hc$coefficients) <- repl.names(names(plr.out.an.rep.hc$coefficients), vars.repl)
names(plr.out.an.rep.ev$coefficients) <- repl.names(names(plr.out.an.rep.ev$coefficients), vars.repl)

```

```{r Framing-Experiment-OP-Republican, include=FALSE}

df.op.rep <- df.op %>% filter(., pid == "Republican")

plr.out.op.rep.hc <- create.formula.plr.out(df.op.rep, vars.pid, "hc")
plr.out.op.rep.ev <- create.formula.plr.out(df.op.rep, vars.pid, "ev")

# adjust names (has to be done after tidy() because tidy() throws up an error otherwise)
names(plr.out.op.rep.hc$coefficients) <- repl.names(names(plr.out.op.rep.hc$coefficients), vars.repl)
names(plr.out.op.rep.ev$coefficients) <- repl.names(names(plr.out.op.rep.ev$coefficients), vars.repl)

```

```{r ANES-OP-Republican-Table, include=FALSE}

stargazer(plr.out.an.rep.hc, plr.out.op.rep.hc, plr.out.an.rep.ev, plr.out.op.rep.ev,
          header= FALSE,
          align = TRUE,
          single.row = TRUE,
          title = "Ordinal Logistic Regression Results, Republican",
          label = "exp-anes-op-rep",
          star.char = c("", "", ""),
          omit.table.layout = "n",
          ci = TRUE,
          dep.var.labels = c("Healthcare", "Environment"),
          column.labels = c("ANES", "OP", "ANES", "OP"),
          column.sep.width = "-60pt",
          model.numbers = FALSE)

```


\ssp

\footnotesize

\blandscape
\centering
\captionof{table}{Ordinal Logistic Regression Results, Republican\label{exp-anes-op-rep}}
\begin{tabular}{@{\extracolsep{-60pt}}lD{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{4}{c}{\textit{Dependent variable:}} \\ 
\cline{2-5} 
\\[-1.8ex] & \multicolumn{2}{c}{Healthcare} & \multicolumn{2}{c}{Environment} \\ 
 & \multicolumn{1}{c}{ANES} & \multicolumn{1}{c}{OP} & \multicolumn{1}{c}{ANES} & \multicolumn{1}{c}{OP} \\ 
\hline \\[-1.8ex] 
 Moral opposing & -0.261$ $(-1.013$, $0.490) & -0.732^{}$ $(-1.397$, $-0.067) & -1.009^{}$ $(-1.711$, $-0.306) & -0.088$ $(-0.706$, $0.531) \\ 
  Moral supporting & 0.131$ $(-0.586$, $0.847) & -0.471$ $(-1.130$, $0.189) & -0.304$ $(-1.034$, $0.425) & -0.190$ $(-0.832$, $0.452) \\ 
  Self-interest opposing & -0.699^{}$ $(-1.370$, $-0.028) & -0.949^{}$ $(-1.603$, $-0.296) & -0.343$ $(-1.026$, $0.340) & 0.027$ $(-0.567$, $0.622) \\ 
  Self-interest supporting & -0.302$ $(-1.005$, $0.401) & -0.325$ $(-0.948$, $0.298) & 0.063$ $(-0.591$, $0.716) & 0.258$ $(-0.360$, $0.876) \\ 
  Employed full time & 0.222$ $(-0.743$, $1.188) & -0.114$ $(-0.832$, $0.604) & -0.222$ $(-1.150$, $0.707) & 0.137$ $(-0.608$, $0.882) \\ 
  Employed part time & 0.224$ $(-0.828$, $1.276) & -0.337$ $(-1.145$, $0.472) & -0.142$ $(-1.153$, $0.869) & 0.204$ $(-0.624$, $1.032) \\ 
  Homemaker & -0.048$ $(-1.168$, $1.072) & -0.310$ $(-1.285$, $0.664) & -0.006$ $(-1.116$, $1.103) & 0.109$ $(-0.911$, $1.130) \\ 
  Retired & -0.340$ $(-1.323$, $0.643) & -0.427$ $(-1.187$, $0.334) & -0.275$ $(-1.225$, $0.675) & 0.007$ $(-0.782$, $0.796) \\ 
  Student & 1.285$ $(-0.353$, $2.922) & 0.147$ $(-0.931$, $1.225) & -0.103$ $(-1.677$, $1.472) & -0.885$ $(-2.008$, $0.239) \\ 
  Income & -0.006$ $(-0.149$, $0.137) & -0.105^{}$ $(-0.227$, $0.018) & 0.070$ $(-0.070$, $0.209) & 0.054$ $(-0.066$, $0.174) \\ 
  Male & -0.141$ $(-0.578$, $0.295) & 0.072$ $(-0.344$, $0.488) & -0.147$ $(-0.587$, $0.293) & -0.244$ $(-0.671$, $0.183) \\ 
  5th-6th grade & -2.747^{}$ $(-5.811$, $0.317) &  & 0.288$ $(-2.255$, $2.831) &  \\ 
  7th-8th grade & 0.821$ $(-2.644$, $4.286) &  & 2.312$ $(-0.990$, $5.615) &  \\ 
  9th grade & -0.274$ $(-3.679$, $3.132) &  & 1.690$ $(-1.678$, $5.058) &  \\ 
  10th grade & -15.887^{}$ $(-15.887$, $-15.887) &  & -1.034$ $(-3.888$, $1.820) &  \\ 
  11th grade & -0.750$ $(-3.064$, $1.564) &  & -0.872$ $(-3.107$, $1.364) &  \\ 
  12th grade & -0.518$ $(-3.144$, $2.109) &  & 0.513$ $(-1.981$, $3.007) &  \\ 
  High school graduate & 0.036$ $(-1.515$, $1.587) &  & 1.158^{}$ $(-0.205$, $2.521) &  \\ 
  Some college & -0.341$ $(-1.888$, $1.206) & -0.165$ $(-0.744$, $0.413) & 1.160^{}$ $(-0.207$, $2.527) & 0.352$ $(-0.240$, $0.943) \\ 
  Associate degree & -0.626$ $(-2.207$, $0.955) & -0.209$ $(-0.872$, $0.453) & 0.739$ $(-0.666$, $2.145) & -0.152$ $(-0.818$, $0.514) \\ 
  Bachelor & -0.495$ $(-2.018$, $1.029) & 0.122$ $(-0.489$, $0.733) & 1.224^{}$ $(-0.111$, $2.559) & -0.262$ $(-0.880$, $0.356) \\ 
  Master & -1.154$ $(-2.772$, $0.465) &  & 0.868$ $(-0.564$, $2.300) &  \\ 
  Professional degree & -1.146$ $(-3.198$, $0.906) &  & 0.658$ $(-1.457$, $2.772) &  \\ 
  Master or higher &  & -0.117$ $(-0.819$, $0.586) &  & -0.097$ $(-0.814$, $0.619) \\ 
 \hline \\[-1.8ex] 
Observations & \multicolumn{1}{c}{318} & \multicolumn{1}{c}{331} & \multicolumn{1}{c}{318} & \multicolumn{1}{c}{331} \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\fillandplacepagenumber
\elandscape

\dsp

\normalsize



```{r Framing-Experiment-ANES-Democrat, include=FALSE}

df.an.dem <- df.an %>% filter(., pid == "Democrat")

plr.out.an.dem.hc <- create.formula.plr.out(df.an.dem, vars.pid, "hc")
plr.out.an.dem.ev <- create.formula.plr.out(df.an.dem, vars.pid, "ev")

# adjust names (has to be done after tidy() because tidy() throws up an error otherwise)
names(plr.out.an.dem.hc$coefficients) <- repl.names(names(plr.out.an.dem.hc$coefficients), vars.repl)
names(plr.out.an.dem.ev$coefficients) <- repl.names(names(plr.out.an.dem.ev$coefficients), vars.repl)

```

```{r Framing-Experiment-OP-Democrat, include=FALSE}

df.op.dem <- df.op %>% filter(., pid == "Democrat")

plr.out.op.dem.hc <- create.formula.plr.out(df.op.dem, vars.pid, "hc")
plr.out.op.dem.ev <- create.formula.plr.out(df.op.dem, vars.pid, "ev")

# adjust names (has to be done after tidy() because tidy() throws up an error otherwise)
names(plr.out.op.dem.hc$coefficients) <- repl.names(names(plr.out.op.dem.hc$coefficients), vars.repl)
names(plr.out.op.dem.ev$coefficients) <- repl.names(names(plr.out.op.dem.ev$coefficients), vars.repl)

```

```{r ANES-OP-Democrat-Table, include=FALSE}

stargazer(plr.out.an.dem.hc, plr.out.op.dem.hc, plr.out.an.dem.ev, plr.out.op.dem.ev,
          header= FALSE,
          align = TRUE,
          single.row = TRUE,
          title = "Ordinal Logistic Regression Results, Democrat",
          label = "exp-anes-op-dem",
          star.char = c("", "", ""),
          omit.table.layout = "n",
          ci = TRUE,
          dep.var.labels = c("Healthcare", "Environment"),
          column.labels = c("ANES", "OP", "ANES", "OP"),
          column.sep.width = "-60pt",
          model.numbers = FALSE)

```


\ssp

\footnotesize

\blandscape
\centering
\captionof{table}{Ordinal Logistic Regression Results, Democrat\label{exp-anes-op-dem}}
\begin{tabular}{@{\extracolsep{-60pt}}lD{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{4}{c}{\textit{Dependent variable:}} \\ 
\cline{2-5} 
\\[-1.8ex] & \multicolumn{2}{c}{Healthcare} & \multicolumn{2}{c}{Environment} \\ 
 & \multicolumn{1}{c}{ANES} & \multicolumn{1}{c}{OP} & \multicolumn{1}{c}{ANES} & \multicolumn{1}{c}{OP} \\ 
\hline \\[-1.8ex] 
 Moral opposing & -0.304$ $(-0.890$, $0.283) & -0.781^{}$ $(-1.363$, $-0.199) & -0.676^{}$ $(-1.317$, $-0.036) & -0.671^{}$ $(-1.225$, $-0.116) \\ 
  Moral supporting & 0.415$ $(-0.167$, $0.997) & -0.310$ $(-0.871$, $0.252) & -0.110$ $(-0.733$, $0.514) & -0.591^{}$ $(-1.159$, $-0.022) \\ 
  Self-interest opposing & -0.042$ $(-0.574$, $0.490) & -0.136$ $(-0.712$, $0.440) & -0.145$ $(-0.763$, $0.474) & -0.513^{}$ $(-1.081$, $0.054) \\ 
  Self-interest supporting & -0.073$ $(-0.664$, $0.517) & -0.135$ $(-0.688$, $0.419) & 0.497^{}$ $(-0.085$, $1.079) & -0.559^{}$ $(-1.138$, $0.019) \\ 
  Employed full time & 0.010$ $(-0.634$, $0.653) & -0.027$ $(-0.641$, $0.586) & -0.296$ $(-0.950$, $0.358) & 0.229$ $(-0.378$, $0.835) \\ 
  Employed part time & 0.113$ $(-0.586$, $0.813) & -0.079$ $(-0.748$, $0.591) & -0.403$ $(-1.115$, $0.309) & -0.027$ $(-0.690$, $0.636) \\ 
  Homemaker & 0.469$ $(-0.552$, $1.490) & 0.132$ $(-0.808$, $1.072) & 0.271$ $(-0.772$, $1.315) & -0.199$ $(-1.110$, $0.711) \\ 
  Retired & 0.171$ $(-0.497$, $0.839) & 0.505$ $(-0.158$, $1.169) & 0.085$ $(-0.584$, $0.754) & 0.895^{}$ $0.234$, $1.557) \\ 
  Student & -0.257$ $(-1.303$, $0.789) & -0.288$ $(-1.237$, $0.662) & -0.838$ $(-1.926$, $0.250) & 0.510$ $(-0.458$, $1.479) \\ 
  Income & -0.026$ $(-0.138$, $0.085) & -0.052$ $(-0.166$, $0.061) & -0.024$ $(-0.139$, $0.091) & 0.049$ $(-0.064$, $0.162) \\ 
  Male & 0.006$ $(-0.380$, $0.392) & 0.092$ $(-0.282$, $0.465) & -0.108$ $(-0.491$, $0.275) & -0.175$ $(-0.551$, $0.200) \\ 
  1st-4th grade & 19.675^{}$ $(17.269$, $22.080) &  & 0.217$ $(-4.350$, $4.785) &  \\ 
  7th-8th grade & 0.525^{}$ $0.525$, $0.525) &  & -15.604^{}$ $(-15.604$, $-15.604) &  \\ 
  9th grade & 21.793^{}$ $(19.747$, $23.839) &  & -1.359$ $(-6.089$, $3.371) &  \\ 
  10th grade & 24.851^{}$ $(22.655$, $27.048) &  & 2.036$ $(-2.670$, $6.741) &  \\ 
  11th grade & 23.857^{}$ $(21.309$, $26.404) &  & 0.149$ $(-4.363$, $4.660) &  \\ 
  12th grade & 22.521^{}$ $(20.929$, $24.114) &  & 0.791$ $(-3.562$, $5.144) &  \\ 
  High school graduate & 22.797^{}$ $(22.182$, $23.412) &  & 0.546$ $(-3.447$, $4.538) &  \\ 
  Some college & 23.051^{}$ $(22.499$, $23.603) & 0.566^{}$ $0.004$, $1.129) & 1.217$ $(-2.767$, $5.201) & 0.207$ $(-0.350$, $0.764) \\ 
  Associate degree & 23.238^{}$ $(22.583$, $23.894) & 0.402$ $(-0.231$, $1.034) & 1.483$ $(-2.517$, $5.483) & 0.365$ $(-0.280$, $1.009) \\ 
  Bachelor & 23.384^{}$ $(22.841$, $23.926) & 0.213$ $(-0.334$, $0.760) & 1.745$ $(-2.226$, $5.717) & 0.019$ $(-0.547$, $0.585) \\ 
  Master & 23.704^{}$ $(23.067$, $24.342) &  & 1.784$ $(-2.196$, $5.764) &  \\ 
  Professional degree & 23.191^{}$ $(22.116$, $24.265) &  & 1.935$ $(-2.144$, $6.015) &  \\ 
  Doctorate & 23.703^{}$ $(22.721$, $24.685) &  & 1.418$ $(-2.668$, $5.504) &  \\ 
  Master or higher &  & 0.694^{}$ $0.060$, $1.328) &  & -0.058$ $(-0.677$, $0.562) \\ 
 \hline \\[-1.8ex] 
Observations & \multicolumn{1}{c}{412} & \multicolumn{1}{c}{422} & \multicolumn{1}{c}{412} & \multicolumn{1}{c}{422} \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\fillandplacepagenumber
\elandscape

\dsp

\normalsize







## Imputing 10 Variables with Missing Data {#app-framing-10var}

```{r MAR 10 Variables Framing, include=FALSE}

mar.10var.frame.an <- read.csv("data/framing/experiment/mar/results/framing.an.mar.results.10var.1062n.1000it.20perc.csv", stringsAsFactors = TRUE, check.names = FALSE)  %>% .[,-1] %>% addPlus
mar.10var.frame.op <- read.csv("data/framing/experiment/mar/results/framing.op.mar.results.10var.1103n.1000it.20perc.csv", stringsAsFactors = TRUE, check.names = FALSE)  %>% .[,-1] %>% addPlus

mar.10var.frame.an[49:54, 2] <- mar.10var.frame.op[49:54, 2] <- rep("Democrat", 6)

mar.10var.frame.an$diff[mar.10var.frame.an$method == "true"] <- mar.10var.frame.an$value[mar.10var.frame.an$method == "true"]
mar.10var.frame.op$diff[mar.10var.frame.op$method == "true"] <- mar.10var.frame.op$value[mar.10var.frame.op$method == "true"]

levels(mar.10var.frame.op$method) <- levels(mar.10var.frame.an$method) <- levs

mar.10var.frame <- cbind(mar.10var.frame.an[, c(1,2,4)], mar.10var.frame.op[,4])
colnames(mar.10var.frame) <- c("Method", "Variable", "ANES", "OP")

# to make the in-text citations shorter
mar.10.frame.an <- mar.10var.frame$ANES
mar.10.frame.op <- mar.10var.frame$OP
mar.10.frame.meth <- mar.10var.frame$Method
mar.10.frame.var <- mar.10var.frame$Variable

tab.mar.10var.frame <- stargazer(mar.10var.frame, 
                                 summary = FALSE,
                                 align = TRUE,
                                 header = FALSE,
                                 rownames = FALSE,
                                 digits = 4,
                                 title = "Accuracy of Multiple Imputation Methods. Framing Data, MAR, 10 Variables with NA",
                                 label = "mar.10var.frame")

qt <- gsub("\\multicolumn{1}{c}{", "", tab.mar.10var.frame, fixed = TRUE)
cat(qt)


```


Table \ref{mar.10var.frame} shows the imputation results for missing data inserted at random for 10 variables. In addition to the 5 variables in Table \ref{mar.10var.frame}, missing data is also inserted for `Student`, `Conservative`, `Black`, `Hispanic`, and `Asian`. All of these are binary variables. The results are virtually identical for all methods for `Democrat`, `Male`, `Student`, `Conservative`, `Black`, `Hispanic`, `Asian` for both data sets. The only exception among the binary variables is `Employed`, where `hd.ord` and `hot.deck` perform worse than `mice` and `amelia`. The results for `Income` and `Age` repeat the pattern from Table \ref{mar.5var.frame}: `amelia` overall beats `mice`, the hot decking methods show a much larger distance, and `hd.ord` performs worst out of all methods. Notably, `na.omit` produces better results than the hot decking methods for `Age` for both data sets.

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. Framing Data, MAR, 10 Variables with NA}   
 \label{mar.10var.frame}  
 \\[-1.8ex]\hline
 \hline \\[-1.8ex] 
\multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{OP} \\ 
 \hline \\[-1.8ex] 
 true & Democrat & 0.&3879 & 0.&3826 \\ 
 hot.deck & Democrat & + 0.&0003 & + 0.&0003 \\ 
 hd.ord & Democrat & + 0.&0002 & + 0.&0003 \\
 amelia & Democrat & + 0.&0002 & + 0.&0000 \\
 mice & Democrat & + 0.&0001 & --0.&0001 \\
 na.omit & Democrat & --0.&0217 & --0.&0249 \\
 true & Male & 0.&4576 & 0.&4714 \\ 
 hot.deck & Male & --0.&0001 & + 0.&0003 \\
 hd.ord & Male & + 0.&0000 & + 0.&0002 \\
 amelia & Male & + 0.&0001 & + 0.&0000 \\ 
 mice & Male & + 0.&0000 & --0.&0001 \\  
 na.omit & Male & --0.&0334 & --0.&0325 \\ 
 true & Employed & 0.&5612 & 0.&5684 \\ 
 hot.deck & Employed & + 0.&0013 & + 0.&0013 \\
 hd.ord & Employed & + 0.&0013 & + 0.&0014 \\ 
 amelia & Employed & + 0.&0002 & + 0.&0001 \\
 mice & Employed & + 0.&0000 & + 0.&0000 \\ 
 na.omit & Employed & --0.&0277 & --0.&0260 \\
 true & Income & 3.&5537 & 3.&4923 \\  
 hot.deck & Income & --0.&0037 & --0.&0035 \\ 
 hd.ord & Income & --0.&0081 & --0.&0074 \\ 
 amelia & Income & + 0.&0000 & --0.&0001 \\
 mice & Income & --0.&0001 & --0.&0002 \\  
 na.omit & Income & --0.&1501 & --0.&1504 \\ 
 true & Age & 46.&3475 & 44.&9574 \\ 
 hot.deck & Age & --0.&1106 & --0.&1115 \\ 
 hd.ord & Age & --0.&1632 & --0.&1593 \\
 amelia & Age & --0.&0019 & + 0.&0008 \\ 
 mice & Age & --0.&0068 & --0.&0009 \\ 
 na.omit & Age & --0.&0890 & --0.&0921 \\ 
 true & Student & 0.&0386 & 0.&0481 \\ 
 hot.deck & Student & --0.&0001 & + 0.&0000 \\
 hd.ord & Student & + 0.&0000 & + 0.&0001 \\
 amelia & Student & + 0.&0001 & + 0.&0000 \\
 mice & Student & + 0.&0000 & --0.&0001 \\
 na.omit & Student & --0.&0069 & --0.&0065 \\ 
 true & Conservative & 0.&3908 & 0.&3744 \\ 
 hot.deck & Conservative & + 0.&0001 & + 0.&0004 \\
 hd.ord & Conservative & --0.&0002 & + 0.&0003 \\ 
 amelia & Conservative & + 0.&0000 & + 0.&0001 \\ 
 mice & Conservative & --0.&0002 & + 0.&0002 \\
 na.omit & Conservative & --0.&0177 & --0.&0193 \\
 true & Black & 0.&1158 & 0.&1242 \\ 
 hot.deck & Black & + 0.&0004 & + 0.&0003 \\ 
 hd.ord & Black & + 0.&0005 & + 0.&0004 \\ 
 amelia & Black & + 0.&0000 & + 0.&0000 \\ 
 mice & Black & + 0.&0001 & + 0.&0000 \\
 na.omit & Black & --0.&0094 & --0.&0086 \\
 true & Democrat & 0.&0895 & 0.&0907 \\ 
 hot.deck & Democrat & + 0.&0004 & + 0.&0003 \\ 
 hd.ord & Democrat & + 0.&0003 & + 0.&0001 \\ 
 amelia & Democrat & + 0.&0000 & + 0.&0000 \\
 mice & Democrat & --0.&0001 & + 0.&0000 \\
 na.omit & Democrat & --0.&0126 & --0.&0152 \\ 
 true & Asian & 0.&0810 & 0.&0662 \\
 hot.deck & Asian & + 0.&0001 & --0.&0002 \\ 
 hd.ord & Asian & + 0.&0000 & --0.&0001 \\
 amelia & Asian & + 0.&0001 & + 0.&0000 \\
 mice & Asian & + 0.&0000 & + 0.&0000 \\ 
 na.omit & Asian & --0.&0165 & --0.&0142 \\ 
 \hline \\[-1.8ex]
 \end{longtable}

\dsp

\normalsize


```{r MNAR 10 Variables Framing, include=FALSE}

mnar.10var.frame.an <- read.csv("data/framing/experiment/mnar/results/framing.an.mnar.results.10var.1062n.1000it.20perc.csv", stringsAsFactors = TRUE, check.names = FALSE)  %>% .[,-1] %>% addPlus
mnar.10var.frame.op <- read.csv("data/framing/experiment/mnar/results/framing.op.mnar.results.10var.1103n.1000it.20perc.csv", stringsAsFactors = TRUE, check.names = FALSE)  %>% .[,-1] %>% addPlus

mnar.10var.frame.an[49:54, 2] <- mnar.10var.frame.op[49:54, 2] <- rep("Democrat", 6)

mnar.10var.frame.an$diff[mnar.10var.frame.an$method == "true"] <- mnar.10var.frame.an$value[mnar.10var.frame.an$method == "true"]
mnar.10var.frame.op$diff[mnar.10var.frame.op$method == "true"] <- mnar.10var.frame.op$value[mnar.10var.frame.op$method == "true"]

levels(mnar.10var.frame.op$method) <- levels(mnar.10var.frame.an$method) <- levs

mnar.10var.frame <- cbind(mnar.10var.frame.an[, c(1,2,4)], mnar.10var.frame.op[,4])
colnames(mnar.10var.frame) <- c("Method", "Variable", "ANES", "OP")

# to make the in-text citations shorter
mnar.10.frame.an <- mnar.10var.frame$ANES
mnar.10.frame.op <- mnar.10var.frame$OP
mnar.10.frame.meth <- mnar.10var.frame$Method
mnar.10.frame.var <- mnar.10var.frame$Variable

tab.mnar.10var.frame <- stargazer(mnar.10var.frame, 
                                  summary = FALSE,
                                  align = TRUE,
                                  header = FALSE,
                                  rownames = FALSE,
                                  digits = 4,
                                  title = "Accuracy of Multiple Imputation Methods. Framing Data, MNAR, 10 Variables with NA",
                                  label = "mnar.10var.frame")

rt <- gsub("\\multicolumn{1}{c}{", "", tab.mnar.10var.frame, fixed = TRUE)
cat(rt)

```


As was the case for Tables \ref{mar.5var.frame} and \ref{mnar.5var.frame}, all imputation results for missing data inserted not at random for 10 variables (Table \ref{mnar.10var.frame}) are much further away from the true values than in Table \ref{mar.10var.frame}. There are still several binary variables where all methods produce virtually identical results (`Democrat`, `Male`, `Employed`, `Conservative`), but distances between `hd.ord` and `mice`/`amelia` are notably larger for `Student`, `Black`, `Hispanic`, and `Asian`. Similarly to before, the distances between `hd.ord` and `mice`/`amelia` decrease for `Income` and `Age` when compared to the results for 10 variables MAR. `hd.ord` once again performs worst for both interval variables for both data sets. Note that `na.omit` is now overall much closer to the imputation methods and the true values. It even produces the best results for `Age` across all methods for both data sets.

\ssp

\footnotesize

\begin{longtable}{ccr@{}lr@{}l} 
 \caption{Accuracy of Multiple Imputation Methods. Framing Data, MNAR, 10 Variables with NA}   
 \label{mnar.10var.frame}
 \\[-1.8ex]\hline
 \hline \\[-1.8ex]
\multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Variable} & \multicolumn{2}{c}{ANES} & \multicolumn{2}{c}{OP} \\ 
 \hline \\[-1.8ex]  
 true & Democrat & 0.&3879 & 0.&3826 \\
 hot.deck & Democrat & --0.&0015 & --0.&0016 \\
 hd.ord & Democrat & --0.&0019 & --0.&0019 \\
 amelia & Democrat & --0.&0015 & --0.&0015 \\
 mice & Democrat & --0.&0013 & --0.&0014 \\ 
 na.omit & Democrat & --0.&0084 & --0.&0094 \\ 
 true & Male & 0.&4576 & 0.&4714 \\
 hot.deck & Male & --0.&0067 & --0.&0063 \\ 
 hd.ord & Male & --0.&0066 & --0.&0062 \\ 
 amelia & Male & --0.&0066 & --0.&0065 \\
 mice & Male & --0.&0067 & --0.&0066 \\
 na.omit & Male & --0.&0102 & --0.&0099 \\ 
 true & Employed & 0.&5612 & 0.&5684 \\ 
 hot.deck & Employed & --0.&0013 & --0.&0015 \\ 
 hd.ord & Employed & --0.&0014 & --0.&0017 \\
 amelia & Employed & --0.&0015 & --0.&0015 \\ 
 mice & Employed & --0.&0015 & --0.&0015 \\
 na.omit & Employed & --0.&0086 & --0.&0077 \\
 true & Income & 3.&5537 & 3.&4923 \\
 hot.deck & Income & --0.&0241 & --0.&0237 \\ 
 hd.ord & Income & --0.&0262 & --0.&0267 \\
 amelia & Income & --0.&0196 & --0.&0212 \\
 mice & Income & --0.&0196 & --0.&0214 \\ 
 na.omit & Income & --0.&0476 & --0.&0490 \\
 true & Age & 46.&3475 & 44.&9574 \\
 hot.deck & Age & --0.&2197 & --0.&2388 \\
 hd.ord & Age & --0.&3100 & --0.&2911 \\ 
 amelia & Age & --0.&1196 & --0.&1307 \\ 
 mice & Age & --0.&1207 & --0.&1341 \\ 
 na.omit & Age & --0.&0274 & --0.&0193 \\ 
 true & Student & 0.&0386 & 0.&0481 \\ 
 hot.deck & Student & --0.&0022 & --0.&0024 \\
 hd.ord & Student & --0.&0023 & --0.&0025 \\
 amelia & Student & --0.&0020 & --0.&0024 \\
 mice & Student & --0.&0015 & --0.&0018 \\
 na.omit & Student & --0.&0026 & --0.&0032 \\
 true & Conservative & 0.&3908 & 0.&3744 \\
 hot.deck & Conservative & --0.&0043 & --0.&0038 \\
 hd.ord & Conservative & --0.&0045 & --0.&0041 \\
 amelia & Conservative & --0.&0042 & --0.&0045 \\ 
 mice & Conservative & --0.&0044 & --0.&0043 \\
 na.omit & Conservative & --0.&0059 & --0.&0065 \\
 true & Black & 0.&1158 & 0.&1242 \\
 hot.deck & Black & --0.&0032 & --0.&0030 \\
 hd.ord & Black & --0.&0033 & --0.&0030 \\
 amelia & Black & --0.&0023 & --0.&0021 \\
 mice & Black & --0.&0023 & --0.&0020 \\ 
 na.omit & Black & --0.&0049 & --0.&0050 \\ 
 true & Democrat & 0.&0895 & 0.&0907 \\ 
 hot.deck & Democrat & --0.&0027 & --0.&0028 \\
 hd.ord & Democrat & --0.&0034 & --0.&0036 \\
 amelia & Democrat & --0.&0023 & --0.&0022 \\
 mice & Democrat & --0.&0023 & --0.&0021 \\ 
 na.omit & Democrat & --0.&0050 & --0.&0057 \\ 
 true & Asian & 0.&0810 & 0.&0662 \\ 
 hot.deck & Asian & --0.&0034 & --0.&0031 \\ 
 hd.ord & Asian & --0.&0038 & --0.&0032 \\ 
 amelia & Asian & --0.&0023 & --0.&0020 \\
 mice & Asian & --0.&0025 & --0.&0017 \\
 na.omit & Asian & --0.&0059 & --0.&0046 \\ 
 \hline \\[-1.8ex] 
 \end{longtable}

\dsp

\normalsize


